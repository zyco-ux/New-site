<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Bare Zorynth - Login & Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Roboto+Slab:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Cloudinary Widget -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* ============================================
           CSS RESET & VARIABLES
        ============================================ */
        :root {
            --primary-blue: #1A237E;
            --dark-blue: #0D1B4C;
            --light-blue: #E8EAF6;
            --accent-gold: #C5A028;
            --success-green: #0D9D6B;
            --warning-orange: #FF9800;
            --danger-red: #D32F2F;
            --admin-purple: #673AB7;
            --text-dark: #121212;
            --text-gray: #3A3A3A;
            --text-light: #666666;
            --bg-light: #F5F7FA;
            --white: #FFFFFF;
            --border-color: #D1D5E3;
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 3px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --border-radius: 10px;
            --border-radius-sm: 6px;
            --sidebar-width: 260px;
            --mobile-padding: 16px;
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 16px);
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 13px;
            --font-size-md: 14px;
            --font-size-lg: 15px;
            --font-size-xl: 16px;
            --font-size-2xl: 18px;
            --font-size-3xl: 20px;
            --font-size-4xl: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 14px;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.4;
            min-height: 100vh;
            overflow-x: hidden;
            font-size: var(--font-size-base);
        }

        /* ============================================
           MOBILE BOTTOM NAVIGATION
        ============================================ */
        .mobile-bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--white);
            border-top: 1px solid var(--border-color);
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -1px 6px rgba(0, 0, 0, 0.04);
        }

        .mobile-bottom-nav.active {
            display: flex;
        }

        .nav-items-container {
            display: flex;
            width: 100%;
            justify-content: space-around;
            align-items: center;
            padding: 0 8px;
        }

        .nav-item-mobile {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: var(--text-light);
            font-size: var(--font-size-xs);
            font-weight: 500;
            padding: 6px 8px;
            border-radius: var(--border-radius-sm);
            transition: all 0.2s ease;
            min-width: 56px;
        }

        .nav-item-mobile i {
            font-size: 16px;
            margin-bottom: 3px;
        }

        .nav-item-mobile.active {
            color: var(--primary-blue);
            background-color: var(--light-blue);
        }

        .nav-item-mobile:active {
            transform: scale(0.95);
        }

        /* Adjust main content for mobile bottom nav */
        @media (max-width: 992px) {
            .main-content {
                padding-bottom: 70px !important;
            }
            
            .login-main-content {
                padding-bottom: 20px;
            }
        }

        /* ============================================
           LOGIN PAGE STYLES - REDESIGNED
        ============================================ */
        .login-page {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding-bottom: var(--safe-area-inset-bottom);
            background: linear-gradient(135deg, var(--bg-light) 0%, #E8F4FF 100%);
        }

        /* Mobile Header */
        .mobile-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px var(--mobile-padding);
            background-color: var(--white);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-gray);
            background: none;
            border: none;
            font-family: inherit;
            font-size: var(--font-size-sm);
            font-weight: 500;
            cursor: pointer;
            padding: 6px;
            border-radius: var(--border-radius-sm);
            transition: background-color 0.2s ease;
        }

        .back-button:active {
            background-color: var(--light-blue);
        }

        .mobile-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 800;
            font-size: var(--font-size-lg);
            color: var(--text-dark);
        }

        .mobile-logo span {
            color: var(--primary-blue);
        }

        .logo-icon {
            color: var(--primary-blue);
            font-size: 18px;
        }

        .mobile-header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .help-button {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--light-blue);
            border: none;
            color: var(--primary-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .help-button:active {
            transform: scale(0.95);
            background-color: var(--primary-blue);
            color: var(--white);
        }

        /* Login Main Content */
        .login-main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0 var(--mobile-padding);
            max-width: 420px;
            margin: 0 auto;
            width: 100%;
        }

        /* Login Header */
        .login-header {
            padding: 24px 0 16px;
            text-align: center;
        }

        .welcome-text {
            font-size: var(--font-size-sm);
            color: var(--text-light);
            margin-bottom: 6px;
            font-weight: 500;
        }

        .login-title {
            font-size: var(--font-size-3xl);
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 6px;
            letter-spacing: -0.5px;
        }

        .login-subtitle {
            font-size: var(--font-size-sm);
            color: var(--text-gray);
            max-width: 280px;
            margin: 0 auto;
            line-height: 1.3;
        }

        /* Login Form */
        .login-form-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 16px 0;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-dark);
            font-size: var(--font-size-sm);
        }

        .input-container {
            position: relative;
        }

        .form-input {
            width: 100%;
            padding: 12px 40px 12px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-base);
            font-family: 'Inter', sans-serif;
            background-color: var(--white);
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.08);
        }

        .input-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .password-toggle {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .password-toggle:active {
            background-color: var(--light-blue);
            color: var(--primary-blue);
        }

        .email-icon, .password-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .email-input, .password-input {
            padding-left: 36px;
        }

        /* Form Options */
        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: var(--font-size-sm);
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .checkbox-container {
            position: relative;
            width: 18px;
            height: 18px;
        }

        .checkbox-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            width: 18px;
            height: 18px;
            background-color: var(--white);
            border: 1.5px solid var(--border-color);
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .checkbox-input:checked ~ .checkmark {
            background-color: var(--primary-blue);
            border-color: var(--primary-blue);
        }

        .checkbox-input:checked ~ .checkmark::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 1px;
            width: 4px;
            height: 8px;
            border: solid white;
            border-width: 0 1.5px 1.5px 0;
            transform: rotate(45deg);
        }

        .forgot-password {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
            padding: 6px;
            border-radius: var(--border-radius-sm);
            transition: background-color 0.2s ease;
            font-size: var(--font-size-sm);
        }

        .forgot-password:active {
            background-color: var(--light-blue);
        }

        /* Login Button */
        .login-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(26, 35, 126, 0.15);
        }

        .login-button:active {
            transform: translateY(1px);
            box-shadow: 0 1px 4px rgba(26, 35, 126, 0.15);
        }

        .login-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* Divider */
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: var(--text-light);
            font-size: var(--font-size-xs);
        }

        .divider::before,
        .divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background-color: var(--border-color);
        }

        .divider-text {
            padding: 0 12px;
            font-weight: 500;
        }

        /* Alternative Login */
        .alternative-login {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .alt-login-btn {
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            background-color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            color: var(--text-dark);
            font-size: var(--font-size-sm);
        }

        .alt-login-btn:active {
            border-color: var(--primary-blue);
            background-color: var(--light-blue);
        }

        .alt-login-btn i {
            font-size: 16px;
        }

        .google-btn {
            color: #DB4437;
        }

        .apple-btn {
            color: #000000;
        }

        /* Security Notice */
        .security-notice {
            background-color: var(--light-blue);
            border-radius: var(--border-radius-sm);
            padding: 12px;
            margin-top: 20px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: var(--font-size-xs);
            color: var(--dark-blue);
            border: 1px solid rgba(26, 35, 126, 0.15);
            line-height: 1.3;
        }

        .security-notice i {
            color: var(--primary-blue);
            font-size: 16px;
            margin-top: 1px;
            flex-shrink: 0;
        }

        /* Create Account */
        .create-account-section {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid var(--border-color);
            margin-top: 20px;
        }

        .create-account-title {
            font-size: var(--font-size-md);
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .create-account-text {
            color: var(--text-gray);
            margin-bottom: 16px;
            font-size: var(--font-size-sm);
            line-height: 1.3;
        }

        .create-account-button {
            width: 100%;
            padding: 12px;
            background-color: transparent;
            color: var(--primary-blue);
            border: 1.5px solid var(--primary-blue);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .create-account-button:active {
            background-color: var(--light-blue);
        }

        /* Mobile Footer */
        .mobile-footer {
            padding: 20px var(--mobile-padding);
            background-color: var(--white);
            border-top: 1px solid var(--border-color);
            margin-top: 16px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 12px;
        }

        .footer-link {
            color: var(--text-gray);
            text-decoration: none;
            font-size: var(--font-size-xs);
            transition: color 0.2s ease;
        }

        .footer-link:active {
            color: var(--primary-blue);
        }

        .copyright {
            text-align: center;
            color: var(--text-light);
            font-size: var(--font-size-xs);
            line-height: 1.2;
        }

        /* Branding Panel - Desktop Only */
        .branding-panel {
            display: none;
        }

        /* ============================================
           DASHBOARD STYLES
        ============================================ */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--white);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .sidebar-header {
            padding: 0 20px 24px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
        }

        .bank-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: var(--font-size-2xl);
            font-weight: 800;
            color: var(--text-dark);
        }

        .bank-logo i {
            font-size: 22px;
            color: var(--primary-blue);
        }

        .bank-logo span {
            color: var(--primary-blue);
        }

        .nav-menu {
            padding: 0 16px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            color: var(--text-gray);
            text-decoration: none;
            border-radius: var(--border-radius-sm);
            margin-bottom: 6px;
            transition: all 0.3s ease;
            font-weight: 500;
            cursor: pointer;
            font-size: var(--font-size-sm);
        }

        .nav-item:hover, .nav-item.active {
            background-color: var(--light-blue);
            color: var(--primary-blue);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
        }

        .nav-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 20px 0;
        }

        /* Quick Actions */
        .quick-actions {
            padding: 0 16px;
            margin-top: 24px;
        }

        .quick-title {
            font-size: var(--font-size-xs);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .quick-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .quick-btn {
            padding: 10px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-dark);
            font-size: var(--font-size-xs);
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .quick-btn:hover {
            border-color: var(--primary-blue);
            background-color: var(--light-blue);
            color: var(--primary-blue);
        }

        .quick-btn i {
            font-size: 16px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 24px;
            min-height: 100vh;
        }

        /* Top Bar - Updated for mobile */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .welcome-section h1 {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 4px;
            letter-spacing: -0.3px;
        }

        .welcome-section p {
            color: var(--text-gray);
            font-size: var(--font-size-sm);
        }

        .welcome-section span {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Updated User Name Display */
        .user-display-name {
            font-size: var(--font-size-xs);
            color: var(--text-light);
            margin-bottom: 4px;
            font-weight: 500;
        }

        .user-display-name span {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Profile Section */
        .profile-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notifications {
            position: relative;
        }

        .notification-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .notification-btn:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 18px;
            height: 18px;
            background-color: var(--danger-red);
            color: var(--white);
            border-radius: 50%;
            font-size: var(--font-size-xs);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Profile Dropdown */
        .profile-dropdown {
            position: relative;
        }

        .profile-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 12px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-toggle:hover {
            border-color: var(--primary-blue);
        }

        .profile-avatar {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 16px;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-upload {
            position: absolute;
            bottom: -4px;
            right: -4px;
            width: 22px;
            height: 22px;
            background-color: var(--primary-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: var(--font-size-xs);
            cursor: pointer;
            border: 2px solid var(--white);
        }

        .profile-info {
            text-align: left;
        }

        .profile-name {
            font-weight: 600;
            color: var(--text-dark);
            font-size: var(--font-size-sm);
        }

        .profile-account {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        .profile-arrow {
            color: var(--text-light);
            font-size: var(--font-size-sm);
        }

        .profile-menu {
            position: absolute;
            top: 100%;
            right: 0;
            width: 260px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            margin-top: 8px;
            display: none;
            z-index: 1000;
            overflow: hidden;
        }

        .profile-menu.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-header {
            padding: 16px;
            background-color: var(--light-blue);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .profile-header .profile-avatar {
            width: 52px;
            height: 52px;
            font-size: 20px;
        }

        .profile-details h4 {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: var(--font-size-md);
        }

        .profile-details p {
            font-size: var(--font-size-sm);
            color: var(--text-gray);
        }

        .menu-items {
            padding: 12px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            color: var(--text-dark);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: var(--font-size-sm);
        }

        .menu-item:hover {
            background-color: var(--bg-light);
            color: var(--primary-blue);
        }

        .menu-item i {
            width: 18px;
            text-align: center;
            color: var(--text-light);
            font-size: 14px;
        }

        .menu-item:hover i {
            color: var(--primary-blue);
        }

        .menu-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 8px 0;
        }

        /* Main Dashboard Content */
        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
        }

        /* Account Summary */
        .account-summary {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            border-radius: var(--border-radius);
            padding: 24px;
            color: var(--white);
            margin-bottom: 24px;
            box-shadow: var(--shadow-md);
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .summary-title {
            font-size: var(--font-size-sm);
            opacity: 0.9;
            margin-bottom: 6px;
        }

        .balance-amount {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-4xl);
            font-weight: 700;
            line-height: 1;
            margin-bottom: 4px;
            letter-spacing: 0.3px;
        }

        .balance-change {
            font-size: var(--font-size-sm);
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .balance-change.positive {
            color: #4ade80;
        }

        .balance-change.negative {
            color: #fca5a5;
        }

        .summary-actions {
            display: flex;
            gap: 10px;
        }

        .summary-btn {
            padding: 8px 16px;
            background-color: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 40px;
            color: var(--white);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--font-size-sm);
        }

        .summary-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Account Cards */
        .account-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .account-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .account-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .account-type {
            font-size: var(--font-size-sm);
            color: var(--text-light);
        }

        .account-balance {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-2xl);
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .account-number {
            font-size: var(--font-size-sm);
            color: var(--text-light);
            font-family: monospace;
            letter-spacing: 0.8px;
            margin-bottom: 16px;
        }

        .account-actions {
            display: flex;
            gap: 8px;
        }

        .card-btn {
            flex: 1;
            padding: 8px;
            background-color: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-dark);
            font-size: var(--font-size-xs);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .card-btn:hover {
            background-color: var(--primary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }

        /* Recent Transactions */
        .recent-transactions {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-dark);
        }

        .view-all {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
            font-size: var(--font-size-sm);
            cursor: pointer;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .transaction-item:hover {
            background-color: var(--bg-light);
            border-color: var(--primary-blue);
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 16px;
            margin-right: 12px;
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-name {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: var(--font-size-sm);
        }

        .transaction-date {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        .transaction-amount {
            font-family: 'Roboto Slab', serif;
            font-weight: 600;
            font-size: var(--font-size-md);
        }

        .transaction-amount.credit {
            color: var(--success-green);
        }

        .transaction-amount.debit {
            color: var(--danger-red);
        }

        /* Transfer Money Section */
        .transfer-section {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
        }

        .transfer-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .form-group {
            margin-bottom: 4px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-dark);
            font-size: var(--font-size-sm);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-sm);
            font-family: 'Inter', sans-serif;
            background-color: var(--white);
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.08);
        }

        .transfer-button {
            padding: 12px;
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 8px;
        }

        .transfer-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(26, 35, 126, 0.2);
        }

        .transfer-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Quick Transfer Contacts */
        .quick-contacts {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .contacts-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .contact-item:hover, .contact-item.active {
            border-color: var(--primary-blue);
            background-color: var(--light-blue);
        }

        .contact-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-weight: 600;
            margin-right: 10px;
            font-size: var(--font-size-sm);
        }

        .contact-info {
            flex: 1;
        }

        .contact-name {
            font-weight: 500;
            margin-bottom: 2px;
            font-size: var(--font-size-sm);
        }

        .contact-account {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        .contact-transfer {
            padding: 6px 12px;
            background-color: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-xs);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .contact-transfer:hover {
            background-color: var(--dark-blue);
        }

        /* Investment Section */
        .investment-section {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-top: 24px;
        }

        .investment-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .investment-stat {
            text-align: center;
            padding: 16px;
            border-radius: var(--border-radius-sm);
            background-color: var(--bg-light);
        }

        .stat-value {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        /* Bill Payment Section */
        .bill-payment-section {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-top: 24px;
        }

        .bills-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .bill-item {
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .bill-item:hover {
            border-color: var(--primary-blue);
            transform: translateY(-3px);
        }

        .bill-icon {
            width: 44px;
            height: 44px;
            background-color: var(--light-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            color: var(--primary-blue);
            font-size: 18px;
        }

        .bill-name {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: var(--font-size-sm);
        }

        .bill-amount {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-md);
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .bill-due {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        /* Admin Panel */
        .admin-panel {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-top: 24px;
            border-left: 3px solid var(--admin-purple);
        }

        .admin-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .admin-header i {
            color: var(--admin-purple);
            font-size: 18px;
        }

        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .admin-btn {
            padding: 10px;
            background-color: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-dark);
            font-size: var(--font-size-xs);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .admin-btn:hover {
            background-color: var(--admin-purple);
            color: var(--white);
            border-color: var(--admin-purple);
        }

        .admin-btn i {
            font-size: 18px;
        }

        /* Success Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 16px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 32px;
            width: 100%;
            max-width: 440px;
            text-align: center;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-16px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-icon {
            width: 70px;
            height: 70px;
            background-color: rgba(13, 157, 107, 0.08);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: var(--success-green);
            font-size: 30px;
        }

        .modal-title {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-dark);
        }

        .modal-message {
            color: var(--text-gray);
            margin-bottom: 24px;
            line-height: 1.4;
            font-size: var(--font-size-sm);
        }

        .modal-details {
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            margin-bottom: 24px;
            text-align: left;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            font-size: var(--font-size-sm);
        }

        .detail-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .detail-label {
            color: var(--text-light);
        }

        .detail-value {
            font-weight: 600;
            color: var(--text-dark);
        }

        .modal-amount {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-3xl);
            font-weight: 700;
            color: var(--primary-blue);
            margin: 16px 0;
        }

        .modal-button {
            padding: 12px 32px;
            background-color: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-button:hover {
            background-color: var(--dark-blue);
            transform: translateY(-2px);
        }

        /* Admin Modal */
        .admin-modal {
            max-width: 720px;
            text-align: left;
        }

        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 16px;
        }

        .form-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 16px;
        }

        .admin-form-button {
            padding: 10px 20px;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: var(--font-size-sm);
        }

        .admin-form-button.primary {
            background-color: var(--primary-blue);
            color: var(--white);
        }

        .admin-form-button.secondary {
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 12px 16px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1001;
            max-width: 360px;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast-icon {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .toast-success {
            background-color: rgba(13, 157, 107, 0.08);
            color: var(--success-green);
        }

        .toast-error {
            background-color: rgba(211, 47, 47, 0.08);
            color: var(--danger-red);
        }

        .toast-warning {
            background-color: rgba(255, 152, 0, 0.08);
            color: var(--warning-orange);
        }

        .toast-info {
            background-color: rgba(26, 35, 126, 0.08);
            color: var(--primary-blue);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 3px;
            color: var(--text-dark);
            font-size: var(--font-size-sm);
        }

        .toast-message {
            font-size: var(--font-size-xs);
            color: var(--text-gray);
            line-height: 1.2;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }

        .toast-close:hover {
            background-color: var(--bg-light);
            color: var(--text-dark);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 32px;
        }

        .loading-spinner.active {
            display: flex;
        }

        .spinner {
            width: 36px;
            height: 36px;
            border: 2px solid var(--light-blue);
            border-top-color: var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 16px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 40px;
            margin-bottom: 16px;
            color: var(--border-color);
        }

        .empty-state p {
            font-size: var(--font-size-base);
            margin-bottom: 16px;
        }

        /* ============================================
           DESKTOP STYLES (Login & Dashboard)
        ============================================ */
        @media (min-width: 992px) {
            .login-page {
                flex-direction: row;
                padding: 0;
            }

            .mobile-header, .mobile-footer {
                display: none;
            }

            .branding-panel {
                display: flex;
                flex: 1;
                background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
                color: var(--white);
                padding: 48px 40px;
                flex-direction: column;
                justify-content: center;
                position: relative;
                overflow: hidden;
                min-height: 100vh;
            }

            .branding-overlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none" opacity="0.06"><path d="M0,0 L100,0 L100,100 Z" fill="white"/></svg>');
                background-size: cover;
            }

            .desktop-logo {
                display: flex;
                align-items: center;
                gap: 12px;
                margin-bottom: 40px;
                position: relative;
                z-index: 2;
            }

            .desktop-logo-icon {
                font-size: 36px;
                color: var(--accent-gold);
            }

            .desktop-logo-text {
                font-size: var(--font-size-2xl);
                font-weight: 800;
            }

            .desktop-logo-text span {
                font-weight: 300;
            }

            .branding-content {
                position: relative;
                z-index: 2;
                max-width: 440px;
            }

            .branding-title {
                font-size: var(--font-size-3xl);
                font-weight: 700;
                margin-bottom: 20px;
                line-height: 1.2;
            }

            .branding-subtitle {
                font-size: var(--font-size-base);
                opacity: 0.9;
                margin-bottom: 40px;
                line-height: 1.4;
            }

            .features-list {
                list-style: none;
                margin-bottom: 48px;
            }

            .features-list li {
                display: flex;
                align-items: center;
                margin-bottom: 20px;
                font-size: var(--font-size-base);
                line-height: 1.3;
            }

            .feature-icon {
                width: 24px;
                height: 24px;
                background-color: rgba(255, 255, 255, 0.12);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-right: 12px;
                font-size: 11px;
                flex-shrink: 0;
            }

            .branding-footer {
                position: relative;
                z-index: 2;
                font-size: var(--font-size-sm);
                opacity: 0.8;
                margin-top: auto;
            }

            .login-main-content {
                flex: 1;
                max-width: 420px;
                margin: 0 auto;
                padding: 48px 32px;
                justify-content: center;
            }

            .login-header {
                padding: 0 0 24px;
                text-align: left;
            }

            .welcome-text {
                text-align: left;
            }

            .login-title {
                font-size: var(--font-size-3xl);
                text-align: left;
            }

            .login-subtitle {
                max-width: 100%;
                text-align: left;
                margin: 0;
            }

            .login-form-container {
                padding: 28px;
                margin: 0;
                box-shadow: var(--shadow-md);
            }

            .alternative-login {
                grid-template-columns: 1fr 1fr;
            }

            .alt-login-btn:hover {
                border-color: var(--primary-blue);
                background-color: var(--light-blue);
            }
        }

        /* ============================================
           RESPONSIVE DESIGN
        ============================================ */
        @media (max-width: 1200px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                padding: 16px 0;
            }

            .sidebar-header, .nav-item span, .quick-title, .quick-buttons span {
                display: none;
            }

            .bank-logo {
                justify-content: center;
            }

            .bank-logo i {
                font-size: 26px;
            }

            .nav-menu {
                padding: 0 8px;
            }

            .nav-item {
                justify-content: center;
                padding: 14px;
            }

            .quick-buttons {
                grid-template-columns: 1fr;
            }

            .quick-btn {
                padding: 12px;
            }

            .main-content {
                margin-left: 70px;
                padding: 16px;
                padding-bottom: 70px !important;
            }

            .balance-amount {
                font-size: var(--font-size-3xl);
            }

            .form-row {
                grid-template-columns: 1fr;
            }
            
            /* Show mobile bottom nav */
            .mobile-bottom-nav {
                display: flex;
            }
            
            /* Adjust top bar for mobile */
            .top-bar {
                flex-direction: column;
                gap: 8px;
            }
            
            .profile-section {
                width: 100%;
                justify-content: space-between;
            }
            
            .welcome-section h1 {
                font-size: var(--font-size-xl);
            }
            
            .user-display-name {
                font-size: var(--font-size-xs);
            }
        }

        @media (max-width: 768px) {
            .account-cards {
                grid-template-columns: 1fr;
            }

            .summary-header {
                flex-direction: column;
                gap: 16px;
            }

            .summary-actions {
                width: 100%;
                justify-content: space-between;
            }

            .profile-toggle .profile-info {
                display: none;
            }

            .profile-toggle {
                padding: 6px;
            }

            .profile-menu {
                width: 220px;
            }

            .admin-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* Mobile bottom nav adjustments */
            .nav-item-mobile {
                padding: 6px;
                min-width: 44px;
            }
            
            .nav-item-mobile i {
                font-size: 14px;
            }
            
            .nav-item-mobile span {
                font-size: var(--font-size-xs);
            }
        }

        @media (max-width: 576px) {
            .main-content {
                padding: 12px;
                padding-bottom: 70px !important;
            }

            .account-summary {
                padding: 16px;
            }

            .balance-amount {
                font-size: var(--font-size-2xl);
            }

            .account-card {
                padding: 16px;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .view-all {
                align-self: flex-end;
            }

            .toast {
                left: 12px;
                right: 12px;
                bottom: 70px;
                max-width: none;
            }

            .admin-actions {
                grid-template-columns: 1fr;
            }
            
            /* Mobile bottom nav adjustments for very small screens */
            .nav-item-mobile span {
                display: none;
            }
            
            .nav-item-mobile {
                min-width: 36px;
            }
            
            .nav-item-mobile i {
                font-size: 16px;
                margin-bottom: 0;
            }
        }

        /* ============================================
           ANIMATIONS
        ============================================ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-form-container {
            animation: fadeIn 0.4s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-16px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .branding-panel {
            animation: slideIn 0.5s ease;
        }

        /* Hide elements */
        .hidden {
            display: none !important;
        }

        /* ============================================
           FEATURE MODAL STYLES
        ============================================ */
        .feature-modal {
            max-width: 800px;
            text-align: left;
            max-height: 70vh;
            overflow-y: auto;
        }

        .feature-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .feature-section {
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            margin-bottom: 12px;
        }

        .feature-section h3 {
            color: var(--primary-blue);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            font-size: var(--font-size-md);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .feature-item {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 12px;
            border: 1px solid var(--border-color);
        }

        .feature-item h4 {
            color: var(--text-dark);
            margin-bottom: 8px;
            font-size: var(--font-size-base);
        }

        .feature-item p {
            color: var(--text-gray);
            font-size: var(--font-size-sm);
            line-height: 1.3;
        }

        .user-list {
            max-height: 260px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            padding: 8px;
        }

        .user-row {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .user-row:last-child {
            border-bottom: none;
        }

        .user-avatar-small {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-weight: 600;
            margin-right: 10px;
            font-size: var(--font-size-sm);
        }

        .user-info-small {
            flex: 1;
        }

        .user-name-small {
            font-weight: 500;
            margin-bottom: 2px;
            font-size: var(--font-size-sm);
        }

        .user-email-small {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        .user-actions {
            display: flex;
            gap: 4px;
        }

        .action-btn {
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            background-color: var(--white);
            cursor: pointer;
            font-size: var(--font-size-xs);
        }

        .action-btn.edit {
            color: var(--primary-blue);
            border-color: var(--primary-blue);
        }

        .action-btn.delete {
            color: var(--danger-red);
            border-color: var(--danger-red);
        }

        /* Profile Settings Modal */
        .profile-settings-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .profile-preview {
            text-align: center;
            padding: 16px;
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
        }

        .preview-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--light-blue);
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 28px;
            font-weight: 600;
            position: relative;
        }

        /* Investment Details */
        .portfolio-chart {
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            margin: 16px 0;
            text-align: center;
            min-height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
        }

        /* Transaction Details */
        .transaction-detail-view {
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin: 16px 0;
        }

        .transaction-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: var(--font-size-xs);
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-completed {
            background-color: rgba(13, 157, 107, 0.08);
            color: var(--success-green);
        }

        .status-pending {
            background-color: rgba(255, 152, 0, 0.08);
            color: var(--warning-orange);
        }

        .status-failed {
            background-color: rgba(211, 47, 47, 0.08);
            color: var(--danger-red);
        }

        /* Help Center */
        .help-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }

        .help-category {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            border: 1px solid var(--border-color);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .help-category:hover {
            border-color: var(--primary-blue);
            transform: translateY(-3px);
        }

        .help-category i {
            font-size: 28px;
            color: var(--primary-blue);
            margin-bottom: 12px;
        }

        /* System Settings */
        .settings-group {
            margin-bottom: 20px;
        }

        .settings-group h4 {
            margin-bottom: 12px;
            color: var(--text-dark);
            font-size: var(--font-size-md);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
        }

        .setting-info h5 {
            margin-bottom: 4px;
            font-size: var(--font-size-sm);
        }

        .setting-info p {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 22px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 22px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-blue);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }
        
        /* Admin Balance Editor */
        .balance-editor {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            margin-top: 16px;
            border: 1px solid var(--border-color);
        }
        
        .balance-input-group {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            align-items: center;
        }
        
        .balance-input-group label {
            min-width: 100px;
            font-weight: 500;
            font-size: var(--font-size-sm);
        }
        
        .balance-input-group input {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-sm);
        }
        
        /* Mobile Responsive Improvements */
        .mobile-optimized {
            -webkit-overflow-scrolling: touch;
        }
        
        .mobile-friendly-text {
            font-size: var(--font-size-sm);
            line-height: 1.3;
        }
        
        /* Content Sections for Navigation */
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        /* Mobile Action Buttons */
        .mobile-action-buttons {
            display: flex;
            gap: 8px;
            margin: 16px 0;
            flex-wrap: wrap;
        }
        
        .mobile-action-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            background-color: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-sm);
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.3s ease;
        }
        
        .mobile-action-btn:active {
            transform: scale(0.98);
            background-color: var(--dark-blue);
        }
        
        .mobile-action-btn.secondary {
            background-color: var(--white);
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }
        
        .mobile-action-btn.secondary:active {
            background-color: var(--light-blue);
        }

        /* Create Account Form Styles */
        .create-account-form {
            margin-top: 20px;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .step {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--border-color);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
            margin: 0 8px;
            position: relative;
        }

        .step.active {
            background-color: var(--primary-blue);
            color: var(--white);
        }

        .step-line {
            width: 20px;
            height: 2px;
            background-color: var(--border-color);
            align-self: center;
        }

        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* Profile Picture Upload Styles */
        .profile-picture-upload {
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-preview-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 12px;
            border: 3px solid var(--primary-blue);
        }

        .upload-btn {
            background-color: var(--primary-blue);
            color: var(--white);
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            margin: 0 auto;
        }

        .remove-photo-btn {
            background-color: var(--danger-red);
            color: var(--white);
            border: none;
            padding: 6px 12px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            margin-top: 8px;
            font-size: var(--font-size-xs);
        }
        
        /* PIN Input Styles */
        .pin-input-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 16px 0;
        }
        
        .pin-input {
            width: 45px;
            height: 50px;
            text-align: center;
            font-size: var(--font-size-xl);
            font-weight: 600;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            background-color: var(--white);
        }
        
        .pin-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.08);
        }
        
        /* Transaction Download Button */
        .transaction-download-btn {
            padding: 6px 12px;
            background-color: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-xs);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 8px;
        }
        
        .transaction-download-btn:hover {
            background-color: var(--dark-blue);
        }
        
        /* Bank Input Styles */
        .bank-input-group {
            position: relative;
        }
        
        .bank-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }
        
        .bank-suggestion {
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .bank-suggestion:hover {
            background-color: var(--light-blue);
        }
        
        /* Receipt Styles - UPDATED SMALLER SIZE */
        .receipt-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            max-width: 380px;
            margin: 0 auto;
            border: 1px solid var(--border-color);
            font-size: var(--font-size-sm);
        }
        
        .receipt-header {
            text-align: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary-blue);
        }
        
        .receipt-logo {
            font-size: var(--font-size-xl);
            font-weight: 800;
            color: var(--primary-blue);
            margin-bottom: 6px;
        }
        
        .receipt-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .receipt-details {
            margin-bottom: 16px;
        }
        
        .receipt-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid var(--border-color);
            font-size: var(--font-size-sm);
        }
        
        .receipt-row:last-child {
            border-bottom: none;
        }
        
        .receipt-label {
            font-weight: 500;
            color: var(--text-light);
        }
        
        .receipt-value {
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .receipt-amount {
            text-align: center;
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--primary-blue);
            margin: 16px 0;
            padding: 12px;
            background-color: var(--light-blue);
            border-radius: var(--border-radius);
        }
        
        .receipt-footer {
            text-align: center;
            margin-top: 20px;
            padding-top: 12px;
            border-top: 1px dashed var(--border-color);
            color: var(--text-light);
            font-size: var(--font-size-xs);
        }
        
        /* Statement Features */
        .statement-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .statement-feature-card {
            background: linear-gradient(135deg, var(--light-blue), #e3f2fd);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .statement-feature-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-blue);
        }
        
        .statement-feature-icon {
            width: 50px;
            height: 50px;
            background-color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            color: var(--primary-blue);
            font-size: 22px;
            box-shadow: var(--shadow-sm);
        }
        
        .statement-feature-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 6px;
            font-size: var(--font-size-sm);
        }
        
        .statement-feature-desc {
            color: var(--text-light);
            font-size: var(--font-size-xs);
            line-height: 1.3;
        }
        
        /* Statement Period Selector */
        .statement-period-selector {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            margin: 16px 0;
            border: 1px solid var(--border-color);
        }
        
        .period-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 12px;
        }
        
        .period-option {
            padding: 10px;
            background-color: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--font-size-sm);
        }
        
        .period-option:hover, .period-option.active {
            background-color: var(--primary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }
        
        /* Statement Preview */
        .statement-preview {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin: 16px 0;
            border: 2px solid var(--border-color);
            position: relative;
        }
        
        .statement-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .statement-preview-title {
            font-weight: 600;
            color: var(--text-dark);
            font-size: var(--font-size-md);
        }
        
        .statement-preview-content {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--text-light);
            background-color: var(--bg-light);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin: 8px 0;
        }
        
        .statement-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 80px;
            color: rgba(0, 0, 0, 0.05);
            font-weight: 800;
            pointer-events: none;
            user-select: none;
        }
        
        /* Statement History */
        .statement-history {
            margin-top: 20px;
        }
        
        .statement-history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }
        
        .statement-history-item:hover {
            border-color: var(--primary-blue);
            background-color: var(--light-blue);
        }
        
        .statement-history-info h4 {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: var(--font-size-sm);
        }
        
        .statement-history-info p {
            color: var(--text-light);
            font-size: var(--font-size-xs);
        }
        
        .statement-history-actions {
            display: flex;
            gap: 8px;
        }
        
        /* Statement Stats */
        .statement-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        
        .statement-stat {
            background-color: var(--white);
            border-radius: var(--border-radius-sm);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .statement-stat-value {
            font-family: 'Roboto Slab', serif;
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 4px;
        }
        
        .statement-stat-label {
            font-size: var(--font-size-xs);
            color: var(--text-light);
        }
        
        /* Export Options */
        .export-options {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .export-option {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .export-option:hover {
            border-color: var(--primary-blue);
            background-color: var(--light-blue);
        }
        
        .export-option i {
            font-size: 24px;
            color: var(--primary-blue);
        }
        
        .export-option span {
            font-weight: 500;
            font-size: var(--font-size-sm);
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE (Initially visible) -->
    <div class="login-page" id="loginPage">
        <!-- Mobile Header -->
        <header class="mobile-header">
            <button class="back-button" id="backButton">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <div class="mobile-logo">
                <i class="fas fa-university logo-icon"></i>
                <div>Bare<span>Zorynth</span></div>
            </div>
            
            <div class="mobile-header-actions">
                <button class="help-button" id="helpButton">
                    <i class="fas fa-question"></i>
                </button>
            </div>
        </header>

        <!-- Desktop Branding Panel -->
        <div class="branding-panel">
            <div class="branding-overlay"></div>
            
            <div class="desktop-logo">
                <i class="fas fa-university desktop-logo-icon"></i>
                <div class="desktop-logo-text">Bare<span>Zorynth</span></div>
            </div>

            <div class="branding-content">
                <h1 class="branding-title">Secure Banking For Your Financial Future</h1>
                <p class="branding-subtitle">
                    Access your accounts with confidence using our military-grade encryption 
                    and multi-factor authentication.
                </p>

                <ul class="features-list">
                    <li>
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <span>256-bit SSL encryption for maximum security</span>
                    </li>
                    <li>
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <span>Access your accounts from any device, anywhere</span>
                    </li>
                    <li>
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <span>Real-time transaction monitoring and alerts</span>
                    </li>
                    <li>
                        <div class="feature-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <span>24/7 customer support for all your banking needs</span>
                    </li>
                </ul>

                <div class="branding-footer">
                    <p>FDIC Insured  Member FDIC  Equal Housing Lender</p>
                </div>
            </div>
        </div>

        <!-- Login Main Content -->
        <main class="login-main-content">
            <div class="login-header">
                <p class="welcome-text">Welcome Back</p>
                <h1 class="login-title">Log In to Your Account</h1>
                <p class="login-subtitle">Enter your credentials to access your banking dashboard</p>
            </div>

            <div class="login-form-container">
                <!-- Loading Spinner -->
                <div class="loading-spinner" id="loadingSpinner">
                    <div class="spinner"></div>
                </div>

                <form class="login-form" id="loginForm">
                    <div class="form-group">
                        <label for="email" class="form-label">Email Address</label>
                        <div class="input-container">
                            <span class="email-icon">
                                <i class="fas fa-envelope"></i>
                            </span>
                            <input 
                                type="email" 
                                id="email" 
                                class="form-input email-input" 
                                placeholder="Enter your email address"
                                required
                            >
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="password" class="form-label">Password</label>
                        <div class="input-container">
                            <span class="password-icon">
                                <i class="fas fa-lock"></i>
                            </span>
                            <input 
                                type="password" 
                                id="password" 
                                class="form-input password-input" 
                                placeholder="Enter your password"
                                required
                            >
                            <div class="input-icon">
                                <button type="button" class="password-toggle" id="togglePassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-options">
                        <label class="remember-me">
                            <div class="checkbox-container">
                                <input type="checkbox" id="rememberMe" class="checkbox-input">
                                <span class="checkmark"></span>
                            </div>
                            <span>Keep me logged in</span>
                        </label>
                        <a href="#" class="forgot-password" id="forgotPasswordLink">Forgot Password?</a>
                    </div>

                    <button type="submit" class="login-button" id="loginButton">
                        <i class="fas fa-sign-in-alt"></i> ACCESS DASHBOARD
                    </button>

                    <div class="divider">
                        <span class="divider-text">Or continue with</span>
                    </div>

                    <div class="alternative-login">
                        <button type="button" class="alt-login-btn google-btn" id="googleLoginBtn">
                            <i class="fab fa-google"></i> Google
                        </button>
                        <button type="button" class="alt-login-btn apple-btn" id="appleLoginBtn">
                            <i class="fab fa-apple"></i> Apple
                        </button>
                    </div>

                    <div class="security-notice">
                        <i class="fas fa-lock"></i>
                        <div>
                            <strong>Security Notice:</strong> We use advanced security measures to protect your information. 
                            Never share your login credentials with anyone.
                        </div>
                    </div>
                </form>

                <div class="create-account-section">
                    <h3 class="create-account-title">New to Bare Zorynth?</h3>
                    <p class="create-account-text">Create an account to start your financial journey with us</p>
                    <button class="create-account-button" id="createAccountButton">
                        Create New Account
                    </button>
                </div>
            </div>
        </main>

        <!-- Mobile Footer -->
        <footer class="mobile-footer">
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy</a>
                <a href="#" class="footer-link">Terms</a>
                <a href="#" class="footer-link">Security</a>
                <a href="#" class="footer-link">Help</a>
            </div>
            <div class="copyright">
                <p> 2023 Bare Zorynth. All rights reserved. Member FDIC.</p>
            </div>
        </footer>
    </div>

    <!-- DASHBOARD PAGE (Initially hidden) -->
    <div class="dashboard-container hidden" id="dashboardPage">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="bank-logo">
                    <i class="fas fa-university"></i>
                    <span>Bare<span>Zorynth</span></span>
                </div>
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active" id="dashboardNav" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" id="transferNav" data-section="transfer">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transfers</span>
                </a>
                <a href="#" class="nav-item" id="cardsNav" data-section="cards">
                    <i class="fas fa-credit-card"></i>
                    <span>Cards</span>
                </a>
                <a href="#" class="nav-item" id="investmentsNav" data-section="investments">
                    <i class="fas fa-chart-line"></i>
                    <span>Investments</span>
                </a>
                <a href="#" class="nav-item" id="statementsNav" data-section="statements">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Statements</span>
                </a>
                <a href="#" class="nav-item" id="settingsNav" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
                <div class="nav-divider" id="adminDivider" style="display: none;"></div>
                <a href="#" class="nav-item" id="adminNav" data-section="admin" style="display: none;">
                    <i class="fas fa-user-shield"></i>
                    <span>Admin Panel</span>
                </a>
            </nav>

            <div class="nav-divider"></div>

            <div class="quick-actions">
                <div class="quick-title">Quick Actions</div>
                <div class="quick-buttons">
                    <button class="quick-btn" id="payBillBtn">
                        <i class="fas fa-file-invoice"></i>
                        <span>Pay Bill</span>
                    </button>
                    <button class="quick-btn" id="depositCheckBtn">
                        <i class="fas fa-money-check"></i>
                        <span>Deposit Check</span>
                    </button>
                    <button class="quick-btn" id="wireTransferBtn">
                        <i class="fas fa-paper-plane"></i>
                        <span>Wire Transfer</span>
                    </button>
                    <button class="quick-btn" id="findAtmBtn">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Find ATM</span>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="welcome-section">
                    <div class="user-display-name">Welcome back, <span id="userName">Loading...</span>!</div>
                    <h1>Financial Dashboard</h1>
                    <p>Here's your overview for <span id="currentDate">Loading...</span></p>
                </div>

                <div class="profile-section">
                    <div class="notifications">
                        <button class="notification-btn" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notificationCount">3</span>
                        </button>
                    </div>

                    <div class="profile-dropdown">
                        <div class="profile-toggle" id="profileToggle">
                            <div class="profile-avatar" id="profileAvatar">
                                <span id="avatarInitials">LD</span>
                                <img id="avatarImage" src="" alt="Profile Picture" style="display: none;">
                                <div class="avatar-upload" id="avatarUpload">
                                    <i class="fas fa-camera"></i>
                                </div>
                            </div>
                            <div class="profile-info">
                                <div class="profile-name" id="displayName">Loading...</div>
                                <div class="profile-account" id="accountNumber">Account:  </div>
                            </div>
                            <div class="profile-arrow">
                                <i class="fas fa-chevron-down"></i>
                            </div>
                        </div>

                        <div class="profile-menu" id="profileMenu">
                            <div class="profile-header">
                                <div class="profile-avatar" id="menuProfileAvatar">
                                    <span id="menuAvatarInitials">LD</span>
                                    <img id="menuAvatarImage" src="" alt="Profile Picture" style="display: none;">
                                </div>
                                <div class="profile-details">
                                    <h4 id="menuUserName">Loading...</h4>
                                    <p id="menuUserEmail">Loading...</p>
                                </div>
                            </div>
                            <div class="menu-items">
                                <a href="#" class="menu-item" id="profileMenuItem" data-section="profile">
                                    <i class="fas fa-user"></i>
                                    <span>My Profile</span>
                                </a>
                                <a href="#" class="menu-item" id="securityMenuItem" data-section="security">
                                    <i class="fas fa-shield-alt"></i>
                                    <span>Security Settings</span>
                                </a>
                                <a href="#" class="menu-item" id="notificationsMenuItem" data-section="notifications">
                                    <i class="fas fa-bell"></i>
                                    <span>Notifications</span>
                                </a>
                                <div class="menu-divider"></div>
                                <a href="#" class="menu-item" id="helpMenuItem" data-section="help">
                                    <i class="fas fa-question-circle"></i>
                                    <span>Help & Support</span>
                                </a>
                                <a href="#" class="menu-item" id="logoutMenuItem">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Sign Out</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div class="loading-spinner active" id="dashboardLoadingSpinner">
                <div class="spinner"></div>
            </div>

            <!-- Dashboard Content (Initially Hidden) -->
            <div id="dashboardContent" style="display: none;">
                <!-- Dashboard Section -->
                <div class="content-section active" id="dashboardSection">
                    <!-- Account Summary -->
                    <div class="account-summary">
                        <div class="summary-header">
                            <div>
                                <div class="summary-title">Total Balance</div>
                                <div class="balance-amount" id="totalBalance">$0.00</div>
                                <div class="balance-change positive" id="balanceChange">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>Loading...</span>
                                </div>
                            </div>
                            <div class="summary-actions">
                                <button class="summary-btn" id="addMoneyBtn">
                                    <i class="fas fa-plus"></i> Add Money
                                </button>
                                <button class="summary-btn" id="withdrawBtn">
                                    <i class="fas fa-minus"></i> Withdraw
                                </button>
                                <button class="summary-btn" id="loanBtn">
                                    <i class="fas fa-hand-holding-usd"></i> Get Loan
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-content">
                        <!-- Left Column -->
                        <div class="left-column">
                            <!-- Account Cards -->
                            <div class="account-cards">
                                <div class="account-card" id="checkingCard">
                                    <div class="card-header">
                                        <div class="account-type">Checking Account</div>
                                        <i class="fas fa-university" style="color: var(--primary-blue);"></i>
                                    </div>
                                    <div class="account-balance" id="checkingBalance">$0.00</div>
                                    <div class="account-number" id="checkingNumber">**** **** **** </div>
                                    <div class="account-actions">
                                        <button class="card-btn" data-action="transfer" data-account="checking">
                                            <i class="fas fa-exchange-alt"></i> Transfer
                                        </button>
                                        <button class="card-btn" data-action="details" data-account="checking">
                                            <i class="fas fa-info-circle"></i> Details
                                        </button>
                                        <button class="card-btn" data-action="statement" data-account="checking">
                                            <i class="fas fa-file-pdf"></i> Statement
                                        </button>
                                    </div>
                                </div>

                                <div class="account-card" id="savingsCard">
                                    <div class="card-header">
                                        <div class="account-type">Savings Account</div>
                                        <i class="fas fa-piggy-bank" style="color: var(--success-green);"></i>
                                    </div>
                                    <div class="account-balance" id="savingsBalance">$0.00</div>
                                    <div class="account-number" id="savingsNumber">**** **** **** </div>
                                    <div class="account-actions">
                                        <button class="card-btn" data-action="transfer" data-account="savings">
                                            <i class="fas fa-exchange-alt"></i> Transfer
                                        </button>
                                        <button class="card-btn" data-action="details" data-account="savings">
                                            <i class="fas fa-info-circle"></i> Details
                                        </button>
                                        <button class="card-btn" data-action="interest" data-account="savings">
                                            <i class="fas fa-percentage"></i> Interest
                                        </button>
                                    </div>
                                </div>

                                <div class="account-card" id="investmentCard">
                                    <div class="card-header">
                                        <div class="account-type">Investment Portfolio</div>
                                        <i class="fas fa-chart-line" style="color: var(--accent-gold);"></i>
                                    </div>
                                    <div class="account-balance" id="investmentBalance">$0.00</div>
                                    <div class="account-number" id="investmentType">IRA  Roth Account</div>
                                    <div class="account-actions">
                                        <button class="card-btn" data-action="invest" data-account="investment">
                                            <i class="fas fa-chart-line"></i> Invest
                                        </button>
                                        <button class="card-btn" data-action="details" data-account="investment">
                                            <i class="fas fa-info-circle"></i> Details
                                        </button>
                                        <button class="card-btn" data-action="performance" data-account="investment">
                                            <i class="fas fa-chart-bar"></i> Performance
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Transfer Money Section -->
                            <div class="transfer-section">
                                <div class="section-header">
                                    <h2 class="section-title">Transfer Money</h2>
                                    <button class="view-all" id="transferHistoryBtn">
                                        <i class="fas fa-history"></i> History
                                    </button>
                                </div>
                                <form class="transfer-form" id="transferForm">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="fromAccount" class="form-label">From Account</label>
                                            <select id="fromAccount" class="form-control">
                                                <option value="checking">Checking Account</option>
                                                <option value="savings">Savings Account</option>
                                            </select>
                                        </div>
                                        <div class="form-group bank-input-group">
                                            <label for="bankName" class="form-label">Bank Name</label>
                                            <input type="text" id="bankName" class="form-control" placeholder="Enter bank name" required>
                                            <div class="bank-suggestions" id="bankSuggestions">
                                                <!-- Bank suggestions will appear here -->
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="recipientName" class="form-label">Recipient Name</label>
                                            <input type="text" id="recipientName" class="form-control" placeholder="Enter recipient name" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="recipientAccount" class="form-label">Account Number</label>
                                            <input type="text" id="recipientAccount" class="form-control" placeholder="Enter account number" required>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="transferAmount" class="form-label">Amount ($)</label>
                                            <input type="number" id="transferAmount" class="form-control" placeholder="0.00" min="1" step="0.01" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="transferMemo" class="form-label">Memo (Optional)</label>
                                            <input type="text" id="transferMemo" class="form-control" placeholder="e.g., Rent payment">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Transfer Type</label>
                                        <div style="display: flex; gap: 8px; margin-top: 4px;">
                                            <label style="display: flex; align-items: center; gap: 4px;">
                                                <input type="radio" name="transferType" value="standard" checked> Standard (1-2 days)
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 4px;">
                                                <input type="radio" name="transferType" value="express"> Express (Same day)
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group" id="pinInputGroup">
                                        <label for="transferPin" class="form-label">Enter your 4-digit PIN</label>
                                        <div class="pin-input-container">
                                            <input type="password" maxlength="1" class="pin-input" id="pin1">
                                            <input type="password" maxlength="1" class="pin-input" id="pin2">
                                            <input type="password" maxlength="1" class="pin-input" id="pin3">
                                            <input type="password" maxlength="1" class="pin-input" id="pin4">
                                        </div>
                                    </div>

                                    <button type="submit" class="transfer-button" id="submitTransfer">
                                        <i class="fas fa-paper-plane"></i> Send Transfer
                                    </button>
                                </form>
                            </div>

                            <!-- Recent Transactions -->
                            <div class="recent-transactions">
                                <div class="section-header">
                                    <h2 class="section-title">Recent Transactions</h2>
                                    <a href="#" class="view-all" id="viewAllTransactions">
                                        <i class="fas fa-external-link-alt"></i> View All
                                    </a>
                                </div>
                                <div class="transactions-list" id="transactionsList">
                                    <!-- Transactions will be populated here -->
                                </div>
                                <div class="empty-state" id="noTransactions" style="display: none;">
                                    <i class="fas fa-exchange-alt"></i>
                                    <p>No transactions yet. Make your first transfer!</p>
                                    <button class="card-btn" style="margin-top: 8px;" id="makeFirstTransferBtn">
                                        <i class="fas fa-exchange-alt"></i> Make a Transfer
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="right-column">
                            <!-- Quick Transfer Contacts -->
                            <div class="quick-contacts">
                                <div class="section-header">
                                    <h2 class="section-title">Quick Transfer</h2>
                                    <button class="view-all" id="manageContactsBtn">
                                        <i class="fas fa-cog"></i> Manage
                                    </button>
                                </div>
                                <div class="contacts-list" id="contactsList">
                                    <!-- Contacts will be populated here -->
                                </div>
                                <div class="empty-state" id="noContacts" style="display: none;">
                                    <i class="fas fa-users"></i>
                                    <p>No contacts saved yet.</p>
                                    <button class="card-btn" style="margin-top: 8px;" id="addContactBtn">
                                        <i class="fas fa-user-plus"></i> Add Contact
                                    </button>
                                </div>
                            </div>

                            <!-- Bill Payment Section -->
                            <div class="bill-payment-section">
                                <div class="section-header">
                                    <h2 class="section-title">Upcoming Bills</h2>
                                    <a href="#" class="view-all" id="viewAllBills">
                                        <i class="fas fa-external-link-alt"></i> View All
                                    </a>
                                </div>
                                <div class="bills-list" id="billsList">
                                    <!-- Bills will be populated here -->
                                </div>
                                <div class="empty-state" id="noBills" style="display: none;">
                                    <i class="fas fa-file-invoice"></i>
                                    <p>No upcoming bills.</p>
                                    <button class="card-btn" style="margin-top: 8px;" id="setupBillsBtn">
                                        <i class="fas fa-plus"></i> Setup Bill Pay
                                    </button>
                                </div>
                            </div>

                            <!-- Investment Section -->
                            <div class="investment-section">
                                <div class="section-header">
                                    <h2 class="section-title">Investment Overview</h2>
                                    <a href="#" class="view-all" id="investmentDetailsBtn">
                                        <i class="fas fa-chart-line"></i> Details
                                    </a>
                                </div>
                                <div class="investment-stats">
                                    <div class="investment-stat">
                                        <div class="stat-value" id="ytdReturn">0%</div>
                                        <div class="stat-label">YTD Return</div>
                                    </div>
                                    <div class="investment-stat">
                                        <div class="stat-value" id="portfolioValue">$0</div>
                                        <div class="stat-label">Portfolio Value</div>
                                    </div>
                                </div>
                                <button class="transfer-button" style="margin-top: 16px;" id="viewPortfolioBtn">
                                    <i class="fas fa-chart-line"></i> View Portfolio
                                </button>
                            </div>

                            <!-- Admin Panel (Visible only to admins) -->
                            <div class="admin-panel" id="adminPanel" style="display: none;">
                                <div class="admin-header">
                                    <i class="fas fa-user-shield"></i>
                                    <h2 class="section-title">Admin Panel</h2>
                                </div>
                                <div class="admin-actions">
                                    <button class="admin-btn" id="manageUsersBtn">
                                        <i class="fas fa-users"></i>
                                        <span>Manage Users</span>
                                    </button>
                                    <button class="admin-btn" id="manageAccountsBtn">
                                        <i class="fas fa-university"></i>
                                        <span>Manage Accounts</span>
                                    </button>
                                    <button class="admin-btn" id="transactionsAdminBtn">
                                        <i class="fas fa-exchange-alt"></i>
                                        <span>All Transactions</span>
                                    </button>
                                    <button class="admin-btn" id="systemSettingsBtn">
                                        <i class="fas fa-cogs"></i>
                                        <span>System Settings</span>
                                    </button>
                                    <button class="admin-btn" id="editBalancesBtn">
                                        <i class="fas fa-dollar-sign"></i>
                                        <span>Edit Balances</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transfers Section -->
                <div class="content-section" id="transferSection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Money Transfers</h2>
                            <button class="view-all" id="viewTransferHistory">
                                <i class="fas fa-history"></i> History
                            </button>
                        </div>
                        
                        <div class="mobile-action-buttons">
                            <button class="mobile-action-btn" id="quickTransferBtn">
                                <i class="fas fa-bolt"></i> Quick Transfer
                            </button>
                            <button class="mobile-action-btn secondary" id="scheduledTransfersBtn">
                                <i class="fas fa-calendar-alt"></i> Scheduled
                            </button>
                            <button class="mobile-action-btn secondary" id="wireTransferBtnMobile">
                                <i class="fas fa-paper-plane"></i> Wire Transfer
                            </button>
                        </div>
                        
                        <!-- Quick Transfer Form -->
                        <div id="quickTransferForm" style="display: block;">
                            <h3 style="margin-bottom: 16px;">Quick Transfer</h3>
                            <form class="transfer-form" id="mobileTransferForm">
                                <div class="form-group">
                                    <label for="mobileFromAccount" class="form-label">From Account</label>
                                    <select id="mobileFromAccount" class="form-control">
                                        <option value="checking">Checking Account ( 5678)</option>
                                        <option value="savings">Savings Account ( 9012)</option>
                                    </select>
                                </div>
                                
                                <div class="form-group bank-input-group">
                                    <label for="mobileBankName" class="form-label">Bank Name</label>
                                    <input type="text" id="mobileBankName" class="form-control" placeholder="Enter bank name" required>
                                    <div class="bank-suggestions" id="mobileBankSuggestions">
                                        <!-- Bank suggestions will appear here -->
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="mobileRecipient" class="form-label">Recipient</label>
                                    <input type="text" id="mobileRecipient" class="form-control" placeholder="Name or select contact">
                                    <div class="contacts-list" style="margin-top: 8px; display: none;" id="mobileContactsList">
                                        <!-- Mobile contacts will appear here -->
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="mobileAmount" class="form-label">Amount</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="number" id="mobileAmount" class="form-control" placeholder="0.00" min="1" step="0.01">
                                        <button type="button" class="card-btn" style="width: auto;" id="useMaxBtn">Max</button>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="mobilePinInputGroup">
                                    <label for="mobileTransferPin" class="form-label">Enter your 4-digit PIN</label>
                                    <div class="pin-input-container">
                                        <input type="password" maxlength="1" class="pin-input" id="mobilePin1">
                                        <input type="password" maxlength="1" class="pin-input" id="mobilePin2">
                                        <input type="password" maxlength="1" class="pin-input" id="mobilePin3">
                                        <input type="password" maxlength="1" class="pin-input" id="mobilePin4">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Transfer Speed</label>
                                    <div style="display: flex; gap: 8px;">
                                        <button type="button" class="card-btn active" data-speed="standard">Standard (1-2 days)</button>
                                        <button type="button" class="card-btn" data-speed="express">Express (Same day)</button>
                                    </div>
                                </div>
                                
                                <button type="submit" class="transfer-button">
                                    <i class="fas fa-paper-plane"></i> Send Money
                                </button>
                            </form>
                        </div>
                        
                        <!-- Wire Transfer Info -->
                        <div id="wireTransferInfo" style="display: none; margin-top: 20px;">
                            <h3 style="margin-bottom: 16px;">Wire Transfer Information</h3>
                            <div class="feature-section">
                                <h4>Domestic Wire Transfer</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Beneficiary Name</h5>
                                        <p>Your Full Name as on Account</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Account Number</h5>
                                        <p id="wireAccountNumber"> 5678</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Routing Number</h5>
                                        <p>021000021</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Bank Name</h5>
                                        <p>Bare Zorynth Bank</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Bank Address</h5>
                                        <p>123 Financial District, New York, NY 10001</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="feature-section">
                                <h4>International Wire Transfer</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>SWIFT/BIC Code</h5>
                                        <p>BARZUS33</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>IBAN</h5>
                                        <p>US64 BARZ 1100 0000 1234 5678</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Correspondent Bank</h5>
                                        <p>Citibank N.A., New York</p>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="transfer-button" style="margin-top: 16px;" id="startWireTransferBtn">
                                <i class="fas fa-paper-plane"></i> Initiate Wire Transfer
                            </button>
                        </div>
                        
                        <!-- Scheduled Transfers -->
                        <div id="scheduledTransfersInfo" style="display: none; margin-top: 20px;">
                            <h3 style="margin-bottom: 16px;">Scheduled Transfers</h3>
                            <div class="empty-state">
                                <i class="fas fa-calendar-alt"></i>
                                <p>No scheduled transfers.</p>
                                <button class="transfer-button" style="margin-top: 16px;" id="scheduleTransferBtn">
                                    <i class="fas fa-plus"></i> Schedule New Transfer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cards Section -->
                <div class="content-section" id="cardsSection">
                    <div class="account-card" style="margin-bottom: 16px;">
                        <div class="card-header">
                            <div class="account-type">Debit Card</div>
                            <i class="fas fa-credit-card" style="color: var(--primary-blue);"></i>
                        </div>
                        <div class="account-balance">   5678</div>
                        <div class="account-number">Expires 12/25  CVV </div>
                        <div class="account-actions">
                            <button class="card-btn" id="freezeCardBtn">
                                <i class="fas fa-snowflake"></i> Freeze Card
                            </button>
                            <button class="card-btn" id="viewCardDetailsBtn">
                                <i class="fas fa-eye"></i> View Details
                            </button>
                            <button class="card-btn" id="reportCardBtn">
                                <i class="fas fa-flag"></i> Report
                            </button>
                        </div>
                    </div>
                    
                    <div class="mobile-action-buttons">
                        <button class="mobile-action-btn" id="virtualCardBtn">
                            <i class="fas fa-mobile-alt"></i> Virtual Card
                        </button>
                        <button class="mobile-action-btn secondary" id="spendingLimitBtn">
                            <i class="fas fa-chart-pie"></i> Spending Limits
                        </button>
                        <button class="mobile-action-btn secondary" id="cardControlsBtn">
                            <i class="fas fa-sliders-h"></i> Controls
                        </button>
                    </div>
                    
                    <!-- Card Features -->
                    <div class="transfer-section" style="margin-top: 16px;">
                        <h3 style="margin-bottom: 16px;">Card Management</h3>
                        
                        <!-- Freeze Card Panel -->
                        <div id="freezeCardPanel" style="display: none;">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Card Status</h5>
                                    <p id="cardStatusText">Card is active</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="cardFreezeToggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <p style="font-size: var(--font-size-sm); color: var(--text-light); margin-top: 8px;">
                                Freezing your card will temporarily block all transactions. You can unfreeze it anytime.
                            </p>
                        </div>
                        
                        <!-- Virtual Card Panel -->
                        <div id="virtualCardPanel" style="display: none; margin-top: 16px;">
                            <div class="feature-section">
                                <h4>Virtual Card Details</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Card Number</h5>
                                        <p>   9012</p>
                                    </div>
                                    <button class="action-btn edit" id="copyVirtualCardBtn">Copy</button>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Expiry Date</h5>
                                        <p>12/25</p>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>CVV</h5>
                                        <p></p>
                                    </div>
                                    <button class="action-btn edit" id="showCVVBtn">Show</button>
                                </div>
                                <button class="transfer-button" style="margin-top: 16px; width: 100%;" id="generateVirtualCardBtn">
                                    <i class="fas fa-sync-alt"></i> Generate New Virtual Card
                                </button>
                            </div>
                        </div>
                        
                        <!-- Spending Limits Panel -->
                        <div id="spendingLimitsPanel" style="display: none; margin-top: 16px;">
                            <div class="feature-section">
                                <h4>Spending Limits</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Daily Limit</h5>
                                        <p id="dailyLimitText">$5,000.00</p>
                                    </div>
                                    <button class="action-btn edit" id="editDailyLimitBtn">Edit</button>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Monthly Limit</h5>
                                        <p id="monthlyLimitText">$25,000.00</p>
                                    </div>
                                    <button class="action-btn edit" id="editMonthlyLimitBtn">Edit</button>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>International Transactions</h5>
                                        <p>Enabled</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="internationalToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Online Transactions</h5>
                                        <p>Enabled</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="onlineToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Card Controls Panel -->
                        <div id="cardControlsPanel" style="display: none; margin-top: 16px;">
                            <div class="feature-section">
                                <h4>Card Controls</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Contactless Payments</h5>
                                        <p>Enable tap to pay</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="contactlessToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>ATM Withdrawals</h5>
                                        <p>Allow cash withdrawals</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="atmToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Gambling Transactions</h5>
                                        <p>Block gambling sites</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="gamblingToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h5>Transaction Notifications</h5>
                                        <p>Get alerts for all transactions</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="notificationsToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investments Section -->
                <div class="content-section" id="investmentsSection">
                    <div class="investment-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Investment Portfolio</h2>
                            <a href="#" class="view-all" id="investmentPerformanceBtn">
                                <i class="fas fa-chart-line"></i> Performance
                            </a>
                        </div>
                        
                        <div class="investment-stats">
                            <div class="investment-stat">
                                <div class="stat-value" id="mobileYtdReturn">0%</div>
                                <div class="stat-label">YTD Return</div>
                            </div>
                            <div class="investment-stat">
                                <div class="stat-value" id="mobilePortfolioValue">$0</div>
                                <div class="stat-label">Portfolio Value</div>
                            </div>
                        </div>
                        
                        <div class="mobile-action-buttons">
                            <button class="mobile-action-btn" id="investNowBtn">
                                <i class="fas fa-plus-circle"></i> Invest Now
                            </button>
                            <button class="mobile-action-btn secondary" id="viewHoldingsBtn">
                                <i class="fas fa-list"></i> My Holdings
                            </button>
                            <button class="mobile-action-btn secondary" id="marketNewsBtn">
                                <i class="fas fa-newspaper"></i> Market News
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Statements Section (ENHANCED) -->
                <div class="content-section" id="statementsSection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Account Statements</h2>
                            <button class="view-all" id="taxDocumentsBtn">
                                <i class="fas fa-file-alt"></i> Tax Documents
                            </button>
                        </div>
                        
                        <!-- Statement Features -->
                        <div class="statement-features">
                            <div class="statement-feature-card" id="downloadStatementCard">
                                <div class="statement-feature-icon">
                                    <i class="fas fa-download"></i>
                                </div>
                                <div class="statement-feature-title">Download PDF</div>
                                <div class="statement-feature-desc">Download statements as PDF files for offline access</div>
                            </div>
                            
                            <div class="statement-feature-card" id="eStatementCard">
                                <div class="statement-feature-icon">
                                    <i class="fas fa-file-pdf"></i>
                                </div>
                                <div class="statement-feature-title">e-Statements</div>
                                <div class="statement-feature-desc">View electronic statements with interactive charts</div>
                            </div>
                            
                            <div class="statement-feature-card" id="customStatementCard">
                                <div class="statement-feature-icon">
                                    <i class="fas fa-cog"></i>
                                </div>
                                <div class="statement-feature-title">Custom Range</div>
                                <div class="statement-feature-desc">Generate statements for custom date ranges</div>
                            </div>
                            
                            <div class="statement-feature-card" id="shareStatementCard">
                                <div class="statement-feature-icon">
                                    <i class="fas fa-share-alt"></i>
                                </div>
                                <div class="statement-feature-title">Share Securely</div>
                                <div class="statement-feature-desc">Securely share statements with accountants</div>
                            </div>
                        </div>
                        
                        <!-- Statement Period Selector -->
                        <div class="statement-period-selector">
                            <h3 style="margin-bottom: 12px;">Select Statement Period</h3>
                            <div class="period-options">
                                <div class="period-option active" data-period="current">Current Month</div>
                                <div class="period-option" data-period="last">Last Month</div>
                                <div class="period-option" data-period="quarter">This Quarter</div>
                                <div class="period-option" data-period="year">This Year</div>
                                <div class="period-option" data-period="custom">Custom Range</div>
                            </div>
                        </div>
                        
                        <!-- Statement Preview -->
                        <div class="statement-preview">
                            <div class="statement-preview-header">
                                <div class="statement-preview-title">Statement Preview - October 2023</div>
                                <div class="statement-history-actions">
                                    <button class="card-btn" id="refreshStatementBtn">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                            <div class="statement-preview-content">
                                <i class="fas fa-file-pdf" style="font-size: 48px; margin-bottom: 16px; color: var(--primary-blue);"></i>
                                <p>Statement for October 1 - October 31, 2023</p>
                                <p style="font-size: var(--font-size-sm); margin-top: 8px;">Ready to download or view</p>
                            </div>
                            <div class="statement-watermark">BARE ZORYNTH</div>
                        </div>
                        
                        <!-- Export Options -->
                        <div class="export-options">
                            <div class="export-option" id="exportPdfBtn">
                                <i class="fas fa-file-pdf"></i>
                                <span>PDF</span>
                            </div>
                            <div class="export-option" id="exportExcelBtn">
                                <i class="fas fa-file-excel"></i>
                                <span>Excel</span>
                            </div>
                            <div class="export-option" id="exportCsvBtn">
                                <i class="fas fa-file-csv"></i>
                                <span>CSV</span>
                            </div>
                            <div class="export-option" id="exportPrintBtn">
                                <i class="fas fa-print"></i>
                                <span>Print</span>
                            </div>
                        </div>
                        
                        <!-- Statement Stats -->
                        <div class="statement-stats">
                            <div class="statement-stat">
                                <div class="statement-stat-value" id="statementTotalTransactions">45</div>
                                <div class="statement-stat-label">Total Transactions</div>
                            </div>
                            <div class="statement-stat">
                                <div class="statement-stat-value" id="statementTotalDeposits">$12,450.75</div>
                                <div class="statement-stat-label">Total Deposits</div>
                            </div>
                            <div class="statement-stat">
                                <div class="statement-stat-value" id="statementTotalWithdrawals">$8,245.30</div>
                                <div class="statement-stat-label">Total Withdrawals</div>
                            </div>
                            <div class="statement-stat">
                                <div class="statement-stat-value" id="statementEndingBalance">$125,205.45</div>
                                <div class="statement-stat-label">Ending Balance</div>
                            </div>
                        </div>
                        
                        <!-- Recent Statements -->
                        <div class="statement-history">
                            <h3 style="margin-bottom: 12px;">Recent Statements</h3>
                            <div class="statement-history-item">
                                <div class="statement-history-info">
                                    <h4>October 2023 Statement</h4>
                                    <p>Checking Account  October 1 - 31, 2023  PDF</p>
                                </div>
                                <div class="statement-history-actions">
                                    <button class="card-btn" data-action="download">
                                        <i class="fas fa-download"></i> Download
                                    </button>
                                    <button class="card-btn" data-action="view">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </div>
                            </div>
                            <div class="statement-history-item">
                                <div class="statement-history-info">
                                    <h4>Q3 2023 Statement</h4>
                                    <p>Investment Account  July 1 - September 30, 2023  PDF</p>
                                </div>
                                <div class="statement-history-actions">
                                    <button class="card-btn" data-action="download">
                                        <i class="fas fa-download"></i> Download
                                    </button>
                                    <button class="card-btn" data-action="view">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="content-section" id="settingsSection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Account Settings</h2>
                            <button class="view-all" id="privacySettingsBtn">
                                <i class="fas fa-shield-alt"></i> Privacy
                            </button>
                        </div>
                        
                        <div class="mobile-action-buttons">
                            <button class="mobile-action-btn" id="profileSettingsBtn">
                                <i class="fas fa-user"></i> Profile
                            </button>
                            <button class="mobile-action-btn secondary" id="securitySettingsBtn">
                                <i class="fas fa-lock"></i> Security
                            </button>
                            <button class="mobile-action-btn secondary" id="notificationSettingsBtn">
                                <i class="fas fa-bell"></i> Notifications
                            </button>
                        </div>
                        
                        <div style="margin-top: 16px;">
                            <h3 style="margin-bottom: 12px;">Preferences</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Two-Factor Authentication</h5>
                                    <p>Add an extra layer of security</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Biometric Login</h5>
                                    <p>Use Face ID or Touch ID</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Email Notifications</h5>
                                    <p>Receive account updates</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Section -->
                <div class="content-section" id="profileSection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">My Profile</h2>
                            <button class="view-all" id="editProfileBtn">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 16px;">
                            <div class="profile-avatar" style="width: 70px; height: 70px; margin: 0 auto 12px; font-size: 20px;">
                                <span id="profileSectionAvatar">LD</span>
                                <img id="profileSectionImage" src="" alt="Profile Picture" style="display: none;">
                            </div>
                            <h3 id="profileSectionName">Loading...</h3>
                            <p id="profileSectionEmail" style="color: var(--text-light);">Loading...</p>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Email Address</h5>
                                <p id="profileSectionEmailDisplay">Loading...</p>
                            </div>
                            <button class="action-btn edit">Change</button>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Phone Number</h5>
                                <p id="profileSectionPhone">(555) 123-4567</p>
                            </div>
                            <button class="action-btn edit">Update</button>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Address</h5>
                                <p id="profileSectionAddress">123 Main St, Anytown, USA</p>
                            </div>
                            <button class="action-btn edit">Edit</button>
                        </div>
                    </div>
                </div>

                <!-- Security Section -->
                <div class="content-section" id="securitySection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Security Settings</h2>
                            <button class="view-all" id="viewSecurityLogs">
                                <i class="fas fa-history"></i> Logs
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Two-Factor Authentication</h5>
                                <p>Add an extra layer of security</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Login Alerts</h5>
                                <p>Get notified of new logins</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <h5>Biometric Login</h5>
                                <p>Use Face ID or Touch ID</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div style="margin-top: 16px;">
                            <button class="transfer-button" style="width: 100%;" id="changePasswordBtn">
                                <i class="fas fa-key"></i> Change Password
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Notifications Section -->
                <div class="content-section" id="notificationsSection">
                    <div class="recent-transactions" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Notifications</h2>
                            <button class="view-all" id="markAllReadBtn">
                                <i class="fas fa-check-double"></i> Mark All Read
                            </button>
                        </div>
                        
                        <div class="transactions-list" id="notificationsList">
                            <!-- Notifications will be populated here -->
                        </div>
                        
                        <div style="margin-top: 16px;">
                            <h3 style="margin-bottom: 12px;">Notification Settings</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Push Notifications</h5>
                                    <p>Receive alerts on your device</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>Email Notifications</h5>
                                    <p>Receive updates via email</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h5>SMS Alerts</h5>
                                    <p>Receive text messages</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Help Section -->
                <div class="content-section" id="helpSection">
                    <div class="transfer-section" style="margin-top: 0;">
                        <div class="section-header">
                            <h2 class="section-title">Help & Support</h2>
                            <button class="view-all" id="contactSupportBtn">
                                <i class="fas fa-headset"></i> Contact
                            </button>
                        </div>
                        
                        <div class="mobile-action-buttons">
                            <button class="mobile-action-btn" id="faqBtn">
                                <i class="fas fa-question-circle"></i> FAQ
                            </button>
                            <button class="mobile-action-btn secondary" id="guidesBtn">
                                <i class="fas fa-book"></i> Guides
                            </button>
                            <button class="mobile-action-btn secondary" id="contactUsBtn">
                                <i class="fas fa-phone"></i> Contact
                            </button>
                        </div>
                        
                        <div style="margin-top: 16px;">
                            <h3 style="margin-bottom: 12px;">Quick Help</h3>
                            <div class="setting-item" style="cursor: pointer;" onclick="showToast('FAQ', 'Opening answer...', 'info')">
                                <div class="setting-info">
                                    <h5>How do I reset my password?</h5>
                                    <p>Step-by-step guide to reset your password</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="setting-item" style="cursor: pointer;" onclick="showToast('FAQ', 'Opening answer...', 'info')">
                                <div class="setting-info">
                                    <h5>What are the transfer limits?</h5>
                                    <p>Learn about daily and monthly limits</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="setting-item" style="cursor: pointer;" onclick="showToast('FAQ', 'Opening answer...', 'info')">
                                <div class="setting-info">
                                    <h5>How do I deposit a check?</h5>
                                    <p>Mobile check deposit instructions</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="setting-item" style="cursor: pointer;" onclick="showToast('FAQ', 'Opening answer...', 'info')">
                                <div class="setting-info">
                                    <h5>Report suspicious activity</h5>
                                    <p>What to do if you suspect fraud</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Mobile Bottom Navigation -->
        <div class="mobile-bottom-nav" id="mobileBottomNav">
            <div class="nav-items-container">
                <a href="#" class="nav-item-mobile active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Home</span>
                </a>
                <a href="#" class="nav-item-mobile" data-section="transfer">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transfer</span>
                </a>
                <a href="#" class="nav-item-mobile" data-section="cards">
                    <i class="fas fa-credit-card"></i>
                    <span>Cards</span>
                </a>
                <a href="#" class="nav-item-mobile" data-section="investments">
                    <i class="fas fa-chart-line"></i>
                    <span>Invest</span>
                </a>
                <a href="#" class="nav-item-mobile" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>More</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal">
        <div class="modal">
            <div class="modal-icon">
                <i class="fas fa-check"></i>
            </div>
            <h2 class="modal-title" id="modalTitle">Transfer Successful!</h2>
            <p class="modal-message" id="modalMessage">
                Your money transfer has been completed successfully. 
                The funds will be available to the recipient within 1-2 business days.
            </p>
            
            <div class="modal-amount" id="successAmount">$0.00</div>
            
            <div class="modal-details">
                <div class="detail-item">
                    <span class="detail-label">From Account:</span>
                    <span class="detail-value" id="successFrom">Checking  </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">To Recipient:</span>
                    <span class="detail-value" id="successTo">Recipient Name</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Reference Number:</span>
                    <span class="detail-value" id="referenceNumber">TRX-</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Date & Time:</span>
                    <span class="detail-value" id="successTime">Loading...</span>
                </div>
            </div>
            
            <div style="margin-top: 16px;">
                <button class="modal-button" id="downloadReceiptBtn" style="margin-right: 8px;">
                    <i class="fas fa-download"></i> Download Receipt
                </button>
                <button class="modal-button secondary" id="closeModal">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- PIN Verification Modal -->
    <div class="modal-overlay" id="pinVerificationModal">
        <div class="modal">
            <div class="modal-icon" style="background-color: rgba(26, 35, 126, 0.1); color: var(--primary-blue);">
                <i class="fas fa-lock"></i>
            </div>
            <h2 class="modal-title">Enter Your PIN</h2>
            <p class="modal-message">
                Please enter your 4-digit PIN to authorize this transaction.
            </p>
            
            <div class="pin-input-container">
                <input type="password" maxlength="1" class="pin-input" id="verifyPin1">
                <input type="password" maxlength="1" class="pin-input" id="verifyPin2">
                <input type="password" maxlength="1" class="pin-input" id="verifyPin3">
                <input type="password" maxlength="1" class="pin-input" id="verifyPin4">
            </div>
            
            <div style="margin-top: 16px;">
                <button class="modal-button" id="verifyPinBtn">
                    Verify PIN
                </button>
                <button class="modal-button secondary" id="cancelPinBtn" style="margin-top: 8px;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Transaction Edit Modal -->
    <div class="modal-overlay" id="adminTransactionModal">
        <div class="modal admin-modal">
            <div class="modal-icon" style="background-color: rgba(139, 92, 246, 0.1); color: var(--admin-purple);">
                <i class="fas fa-edit"></i>
            </div>
            <h2 class="modal-title">Edit Transaction</h2>
            <div id="adminTransactionContent">
                <!-- Transaction edit form will appear here -->
            </div>
            <div class="form-actions">
                <button class="admin-form-button secondary" id="closeTransactionModal">Cancel</button>
                <button class="admin-form-button primary" id="saveTransactionChanges">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div class="modal-overlay" id="adminModal">
        <div class="modal admin-modal">
            <div class="modal-icon" style="background-color: rgba(139, 92, 246, 0.1); color: var(--admin-purple);">
                <i class="fas fa-user-shield"></i>
            </div>
            <h2 class="modal-title" id="adminModalTitle">Admin Panel</h2>
            <div id="adminModalContent">
                <!-- Content will be loaded dynamically -->
            </div>
            <div class="form-actions">
                <button class="admin-form-button secondary" id="closeAdminModal">Cancel</button>
                <button class="admin-form-button primary" id="saveAdminChanges">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Feature Modal -->
    <div class="modal-overlay" id="featureModal">
        <div class="modal feature-modal">
            <div class="modal-icon" id="featureModalIcon" style="background-color: rgba(26, 35, 126, 0.1); color: var(--primary-blue);">
                <i class="fas fa-cogs"></i>
            </div>
            <h2 class="modal-title" id="featureModalTitle">Feature Details</h2>
            <div class="modal-message" id="featureModalMessage">
                <!-- Content will be loaded dynamically -->
            </div>
            <div id="featureModalContent">
                <!-- Content will be loaded dynamically -->
            </div>
            <button class="modal-button" id="closeFeatureModal">Close</button>
        </div>
    </div>

    <!-- Create Account Modal -->
    <div class="modal-overlay" id="createAccountModal">
        <div class="modal admin-modal">
            <div class="modal-icon" style="background-color: rgba(26, 35, 126, 0.1); color: var(--primary-blue);">
                <i class="fas fa-user-plus"></i>
            </div>
            <h2 class="modal-title">Create New Account</h2>
            
            <div class="create-account-form" id="createAccountForm">
                <div class="step-indicator">
                    <div class="step active">1</div>
                    <div class="step-line"></div>
                    <div class="step">2</div>
                    <div class="step-line"></div>
                    <div class="step">3</div>
                    <div class="step-line"></div>
                    <div class="step">4</div>
                </div>
                
                <!-- Step 1: Basic Info -->
                <div class="form-step active" id="step1">
                    <h3>Basic Information</h3>
                    
                    <div class="form-group">
                        <label for="firstName" class="form-label">First Name *</label>
                        <input type="text" id="firstName" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName" class="form-label">Last Name *</label>
                        <input type="text" id="lastName" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="newEmail" class="form-label">Email Address *</label>
                        <input type="email" id="newEmail" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phoneNumber" class="form-label">Phone Number *</label>
                        <input type="tel" id="phoneNumber" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="dateOfBirth" class="form-label">Date of Birth *</label>
                        <input type="date" id="dateOfBirth" class="form-control" required>
                    </div>
                    
                    <div class="form-navigation">
                        <button type="button" class="admin-form-button secondary" id="closeCreateAccountModal">Cancel</button>
                        <button type="button" class="admin-form-button primary" id="nextStep1">Next</button>
                    </div>
                </div>
                
                <!-- Step 2: Address & Security -->
                <div class="form-step" id="step2">
                    <h3>Address & Security</h3>
                    
                    <div class="form-group">
                        <label for="streetAddress" class="form-label">Street Address *</label>
                        <input type="text" id="streetAddress" class="form-control" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city" class="form-label">City *</label>
                            <input type="text" id="city" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="state" class="form-label">State *</label>
                            <input type="text" id="state" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="zipCode" class="form-label">ZIP Code *</label>
                            <input type="text" id="zipCode" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="country" class="form-label">Country *</label>
                            <select id="country" class="form-control" required>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="UK">United Kingdom</option>
                                <option value="AU">Australia</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="newPassword" class="form-label">Create Password *</label>
                        <input type="password" id="newPassword" class="form-control" required minlength="8">
                        <small style="color: var(--text-light); font-size: var(--font-size-xs);">Minimum 8 characters with letters and numbers</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmPassword" class="form-label">Confirm Password *</label>
                        <input type="password" id="confirmPassword" class="form-control" required>
                    </div>
                    
                    <div class="form-navigation">
                        <button type="button" class="admin-form-button secondary" id="prevStep2">Back</button>
                        <button type="button" class="admin-form-button primary" id="nextStep2">Next</button>
                    </div>
                </div>
                
                <!-- Step 3: Set PIN -->
                <div class="form-step" id="step3">
                    <h3>Set Your Security PIN</h3>
                    
                    <div style="text-align: center; margin-bottom: 24px;">
                        <div class="modal-icon" style="background-color: rgba(26, 35, 126, 0.1); color: var(--primary-blue); margin: 0 auto 16px;">
                            <i class="fas fa-key"></i>
                        </div>
                        <p style="color: var(--text-gray);">Set a 4-digit PIN for authorizing transactions. This PIN will be required for all transfers.</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Enter 4-digit PIN</label>
                        <div class="pin-input-container">
                            <input type="password" maxlength="1" class="pin-input" id="createPin1">
                            <input type="password" maxlength="1" class="pin-input" id="createPin2">
                            <input type="password" maxlength="1" class="pin-input" id="createPin3">
                            <input type="password" maxlength="1" class="pin-input" id="createPin4">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm 4-digit PIN</label>
                        <div class="pin-input-container">
                            <input type="password" maxlength="1" class="pin-input" id="confirmPin1">
                            <input type="password" maxlength="1" class="pin-input" id="confirmPin2">
                            <input type="password" maxlength="1" class="pin-input" id="confirmPin3">
                            <input type="password" maxlength="1" class="pin-input" id="confirmPin4">
                        </div>
                    </div>
                    
                    <div class="form-navigation">
                        <button type="button" class="admin-form-button secondary" id="prevStep3">Back</button>
                        <button type="button" class="admin-form-button primary" id="nextStep3">Next</button>
                    </div>
                </div>
                
                <!-- Step 4: Profile Picture & Review -->
                <div class="form-step" id="step4">
                    <h3>Profile Picture & Review</h3>
                    
                    <div class="profile-picture-upload">
                        <img id="profilePreview" src="" alt="Profile Preview" class="profile-preview-img" style="display: none;">
                        <div id="profileInitialsPreview" style="width: 120px; height: 120px; border-radius: 50%; background-color: var(--light-blue); display: flex; align-items: center; justify-content: center; font-size: 36px; font-weight: 600; color: var(--primary-blue); margin: 0 auto 12px;">
                            JD
                        </div>
                        <button type="button" class="upload-btn" id="uploadProfilePictureBtn">
                            <i class="fas fa-upload"></i> Upload Photo
                        </button>
                        <button type="button" class="remove-photo-btn" id="removeProfilePictureBtn" style="display: none;">
                            <i class="fas fa-trash"></i> Remove Photo
                        </button>
                        <input type="hidden" id="profilePictureUrl">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Account Type</label>
                        <div>
                            <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="radio" name="accountType" value="user" checked> Standard User
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="radio" name="accountType" value="admin"> Administrator
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Terms & Conditions</label>
                        <div style="max-height: 150px; overflow-y: auto; padding: 12px; border: 1px solid var(--border-color); border-radius: var(--border-radius-sm);">
                            <p style="font-size: var(--font-size-xs); line-height: 1.4;">
                                By creating an account, you agree to our Terms of Service and Privacy Policy. 
                                You acknowledge that Bare Zorynth will securely store your personal information 
                                and banking details. All transactions are protected with 256-bit SSL encryption.
                                Your 4-digit PIN is required for all financial transactions and should be kept secret.
                            </p>
                        </div>
                        <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <input type="checkbox" id="agreeTerms" required> I agree to the Terms & Conditions
                        </label>
                    </div>
                    
                    <div class="form-navigation">
                        <button type="button" class="admin-form-button secondary" id="prevStep4">Back</button>
                        <button type="submit" class="admin-form-button primary" id="submitCreateAccount">Create Account</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receipt Modal - UPDATED SMALLER SIZE -->
    <div class="modal-overlay" id="receiptModal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-icon" style="background-color: rgba(16, 185, 129, 0.1); color: var(--success-green);">
                <i class="fas fa-receipt"></i>
            </div>
            <h2 class="modal-title">Transaction Receipt</h2>
            <div id="receiptContent">
                <!-- Receipt content will appear here -->
            </div>
            <div style="margin-top: 16px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;">
                <button class="modal-button" id="printReceiptBtn" style="padding: 10px 16px; font-size: var(--font-size-sm);">
                    <i class="fas fa-print"></i> Print
                </button>
                <button class="modal-button" id="downloadPdfBtn" style="padding: 10px 16px; font-size: var(--font-size-sm);">
                    <i class="fas fa-file-pdf"></i> PDF
                </button>
                <button class="modal-button" id="downloadImageBtn" style="padding: 10px 16px; font-size: var(--font-size-sm);">
                    <i class="fas fa-image"></i> Image
                </button>
                <button class="modal-button secondary" id="closeReceiptBtn" style="padding: 10px 16px; font-size: var(--font-size-sm);">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toastNotification">
        <div class="toast-icon" id="toastIcon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title" id="toastTitle">Notification</div>
            <div class="toast-message" id="toastMessage">This is a notification message.</div>
        </div>
        <button class="toast-close" id="toastClose">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Hidden File Input for Avatar Upload -->
    <input type="file" id="avatarInput" accept="image/*" style="display: none;">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <script>
        // ==============================
        // FIREBASE CONFIGURATION
        // ==============================
        const firebaseConfig = {
            apiKey: "AIzaSyDfVYuGUWrW528Nk_gRaIulalZ1AUalqPw",
            authDomain: "lumiere-bank.firebaseapp.com",
            projectId: "lumiere-bank",
            storageBucket: "lumiere-bank.firebasestorage.app",
            messagingSenderId: "16422937370",
            appId: "1:16422937370:web:9297b9d9f6834ca33b02a3",
            measurementId: "G-N6JBRJ339S"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // ==============================
        // CLOUDINARY CONFIGURATION
        // ==============================
        const cloudinaryConfig = {
            cloudName: 'dzy5eio5y',
            uploadPreset: 'bitboost'
        };

        // ==============================
        // GLOBAL VARIABLES
        // ==============================
        let currentUser = null;
        let userData = null;
        let userAccounts = {};
        let userTransactions = [];
        let userContacts = [];
        let userBills = [];
        let userLoans = [];
        let userCards = [];
        let isAdmin = false;
        let allUsers = [];
        let currentPage = 'dashboard';
        let cloudinaryWidget = null;
        let currentStep = 1;
        let userPin = null;
        let currentTransferData = null;
        let popularBanks = [
            "Chase Bank",
            "Bank of America",
            "Wells Fargo",
            "Citibank",
            "Capital One",
            "U.S. Bank",
            "TD Bank",
            "PNC Bank",
            "HSBC Bank",
            "Ally Bank",
            "Charles Schwab",
            "American Express"
        ];

        // ==============================
        // INITIALIZATION
        // ==============================
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, checking authentication...");
            
            // Set current date for dashboard
            updateCurrentDate();
            
            // Check if user is already logged in (with session persistence)
            checkAuthState();
            
            // Initialize event listeners
            initEventListeners();
            
            // Initialize bank suggestions
            initBankSuggestions();
            
            // Initialize PIN input handling
            initPinInputs();
            
            // Initialize statement features
            initStatementFeatures();
        });

        // Initialize bank suggestions
        function initBankSuggestions() {
            // Desktop bank suggestions
            const bankNameInput = document.getElementById('bankName');
            if (bankNameInput) {
                bankNameInput.addEventListener('input', function() {
                    showBankSuggestions(this.value, 'bankSuggestions');
                });
            }
            
            // Mobile bank suggestions
            const mobileBankNameInput = document.getElementById('mobileBankName');
            if (mobileBankNameInput) {
                mobileBankNameInput.addEventListener('input', function() {
                    showBankSuggestions(this.value, 'mobileBankSuggestions');
                });
            }
        }

        // Initialize statement features
        function initStatementFeatures() {
            // Period selector
            document.querySelectorAll('.period-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.period-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    const period = this.dataset.period;
                    updateStatementPreview(period);
                });
            });
            
            // Statement feature cards
            document.querySelectorAll('.statement-feature-card').forEach(card => {
                card.addEventListener('click', function() {
                    const id = this.id;
                    handleStatementFeatureClick(id);
                });
            });
            
            // Export options
            document.getElementById('exportPdfBtn')?.addEventListener('click', () => {
                exportStatement('pdf');
            });
            
            document.getElementById('exportExcelBtn')?.addEventListener('click', () => {
                exportStatement('excel');
            });
            
            document.getElementById('exportCsvBtn')?.addEventListener('click', () => {
                exportStatement('csv');
            });
            
            document.getElementById('exportPrintBtn')?.addEventListener('click', () => {
                exportStatement('print');
            });
            
            // Refresh statement button
            document.getElementById('refreshStatementBtn')?.addEventListener('click', () => {
                refreshStatement();
            });
        }

        // Show bank suggestions
        function showBankSuggestions(query, containerId) {
            const suggestionsContainer = document.getElementById(containerId);
            if (!suggestionsContainer) return;
            
            if (!query) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            const filteredBanks = popularBanks.filter(bank => 
                bank.toLowerCase().includes(query.toLowerCase())
            );
            
            if (filteredBanks.length === 0) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            suggestionsContainer.innerHTML = '';
            filteredBanks.forEach(bank => {
                const suggestion = document.createElement('div');
                suggestion.className = 'bank-suggestion';
                suggestion.textContent = bank;
                suggestion.addEventListener('click', () => {
                    const input = containerId === 'mobileBankSuggestions' ? 
                        document.getElementById('mobileBankName') : 
                        document.getElementById('bankName');
                    input.value = bank;
                    suggestionsContainer.style.display = 'none';
                });
                suggestionsContainer.appendChild(suggestion);
            });
            
            suggestionsContainer.style.display = 'block';
        }

        // Initialize PIN inputs
        function initPinInputs() {
            // Auto-focus next PIN input
            document.querySelectorAll('.pin-input').forEach((input, index, inputs) => {
                input.addEventListener('input', function() {
                    if (this.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                });
                
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace' && this.value.length === 0 && index > 0) {
                        inputs[index - 1].focus();
                    }
                });
            });
            
            // Close bank suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.bank-input-group')) {
                    document.querySelectorAll('.bank-suggestions').forEach(container => {
                        container.style.display = 'none';
                    });
                }
            });
        }

        // ==============================
        // STATEMENT FUNCTIONS
        // ==============================
        function handleStatementFeatureClick(featureId) {
            switch(featureId) {
                case 'downloadStatementCard':
                    downloadStatement('pdf');
                    break;
                case 'eStatementCard':
                    showEStatement();
                    break;
                case 'customStatementCard':
                    showCustomStatementRange();
                    break;
                case 'shareStatementCard':
                    shareStatement();
                    break;
            }
        }

        function updateStatementPreview(period) {
            const previewContent = document.querySelector('.statement-preview-content');
            if (!previewContent) return;
            
            let title = 'Statement Preview';
            let description = 'Ready to download or view';
            
            switch(period) {
                case 'current':
                    title = 'Statement Preview - Current Month';
                    description = 'October 1 - 31, 2023  Ready to download';
                    break;
                case 'last':
                    title = 'Statement Preview - Last Month';
                    description = 'September 1 - 30, 2023  Ready to download';
                    break;
                case 'quarter':
                    title = 'Statement Preview - Q3 2023';
                    description = 'July 1 - September 30, 2023  Ready to download';
                    break;
                case 'year':
                    title = 'Statement Preview - 2023';
                    description = 'January 1 - December 31, 2023  Ready to download';
                    break;
                case 'custom':
                    title = 'Statement Preview - Custom Range';
                    description = 'Select custom date range  Ready to generate';
                    break;
            }
            
            document.querySelector('.statement-preview-title').textContent = title;
            previewContent.innerHTML = `
                <i class="fas fa-file-pdf" style="font-size: 48px; margin-bottom: 16px; color: var(--primary-blue);"></i>
                <p>${title}</p>
                <p style="font-size: var(--font-size-sm); margin-top: 8px;">${description}</p>
            `;
        }

        function downloadStatement(format) {
            showToast('Statement', `Preparing ${format.toUpperCase()} statement for download...`, 'info');
            
            // Simulate download process
            setTimeout(() => {
                showToast('Success', `Statement downloaded as ${format.toUpperCase()}!`, 'success');
                
                // Create a fake download link
                if (format === 'pdf') {
                    const link = document.createElement('a');
                    link.href = 'data:application/pdf;base64,JVBERi0xLg...'; // Base64 of a sample PDF
                    link.download = `BareZorynth_Statement_${new Date().toISOString().slice(0, 10)}.pdf`;
                    link.click();
                }
            }, 1500);
        }

        function showEStatement() {
            showToast('e-Statement', 'Opening interactive e-statement viewer...', 'info');
            // In a real app, this would open a modal with interactive charts
        }

        function showCustomStatementRange() {
            const customRangeModal = `
                <div class="admin-form">
                    <h3>Custom Statement Range</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate" class="form-label">Start Date</label>
                            <input type="date" id="startDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate" class="form-label">End Date</label>
                            <input type="date" id="endDate" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="statementAccount" class="form-label">Account</label>
                        <select id="statementAccount" class="form-control">
                            <option value="all">All Accounts</option>
                            <option value="checking">Checking Account</option>
                            <option value="savings">Savings Account</option>
                            <option value="investment">Investment Account</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="statementFormat" class="form-label">Format</label>
                        <select id="statementFormat" class="form-control">
                            <option value="pdf">PDF Document</option>
                            <option value="excel">Excel Spreadsheet</option>
                            <option value="csv">CSV File</option>
                        </select>
                    </div>
                </div>
            `;
            
            showFeatureModal('Custom Statement Generator', 'Generate statements for any date range', customRangeModal);
        }

        function shareStatement() {
            showToast('Share Statement', 'Opening secure sharing options...', 'info');
            // In a real app, this would show sharing options
        }

        function exportStatement(format) {
            switch(format) {
                case 'pdf':
                    generatePDFStatement();
                    break;
                case 'excel':
                    generateExcelStatement();
                    break;
                case 'csv':
                    generateCSVStatement();
                    break;
                case 'print':
                    printStatement();
                    break;
            }
        }

        function generatePDFStatement() {
            showToast('Export', 'Generating PDF statement...', 'info');
            
            // Use jsPDF to generate PDF
            setTimeout(() => {
                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Add content to PDF
                    doc.setFontSize(20);
                    doc.text('Bare Zorynth Bank Statement', 20, 20);
                    
                    doc.setFontSize(12);
                    doc.text(`Account Holder: ${userData?.firstName || ''} ${userData?.lastName || ''}`, 20, 40);
                    doc.text(`Statement Period: October 1 - 31, 2023`, 20, 50);
                    doc.text(`Account Number: ${userAccounts.checking?.accountNumber || ' 5678'}`, 20, 60);
                    
                    // Add table headers
                    doc.text('Date', 20, 80);
                    doc.text('Description', 60, 80);
                    doc.text('Amount', 160, 80);
                    
                    // Add sample transactions
                    let yPos = 90;
                    const sampleTransactions = [
                        { date: '10/01/2023', desc: 'Salary Deposit', amount: '$2,500.00' },
                        { date: '10/05/2023', desc: 'Grocery Store', amount: '-$125.50' },
                        { date: '10/10/2023', desc: 'Utility Payment', amount: '-$89.75' },
                        { date: '10/15/2023', desc: 'Investment Return', amount: '$450.25' },
                        { date: '10/20/2023', desc: 'Online Shopping', amount: '-$75.30' }
                    ];
                    
                    sampleTransactions.forEach(transaction => {
                        doc.text(transaction.date, 20, yPos);
                        doc.text(transaction.desc, 60, yPos);
                        doc.text(transaction.amount, 160, yPos);
                        yPos += 10;
                    });
                    
                    // Add totals
                    yPos += 10;
                    doc.text('Ending Balance:', 20, yPos);
                    doc.text('$12,450.75', 160, yPos);
                    
                    // Save the PDF
                    doc.save(`BareZorynth_Statement_${new Date().toISOString().slice(0, 10)}.pdf`);
                    
                    showToast('Success', 'PDF statement generated and downloaded!', 'success');
                } catch (error) {
                    console.error('Error generating PDF:', error);
                    showToast('Error', 'Failed to generate PDF. Please try again.', 'error');
                }
            }, 1000);
        }

        function generateExcelStatement() {
            showToast('Export', 'Generating Excel statement...', 'info');
            // Simulate Excel generation
            setTimeout(() => {
                const csvContent = "data:text/csv;charset=utf-8,Date,Description,Amount,Category,Balance\n" +
                    "10/01/2023,Salary Deposit,2500.00,Income,12500.75\n" +
                    "10/05/2023,Grocery Store,-125.50,Shopping,12375.25\n" +
                    "10/10/2023,Utility Payment,-89.75,Bills,12285.50\n" +
                    "10/15/2023,Investment Return,450.25,Investment,12735.75\n" +
                    "10/20/2023,Online Shopping,-75.30,Shopping,12660.45";
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement('a');
                link.setAttribute('href', encodedUri);
                link.setAttribute('download', `BareZorynth_Statement_${new Date().toISOString().slice(0, 10)}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showToast('Success', 'Excel statement generated and downloaded!', 'success');
            }, 1000);
        }

        function generateCSVStatement() {
            generateExcelStatement(); // Same as Excel for this demo
        }

        function printStatement() {
            window.print();
        }

        function refreshStatement() {
            showToast('Refreshing', 'Updating statement data...', 'info');
            
            // Update statement stats with random data
            document.getElementById('statementTotalTransactions').textContent = Math.floor(Math.random() * 100) + 20;
            document.getElementById('statementTotalDeposits').textContent = formatCurrency(Math.random() * 20000 + 5000);
            document.getElementById('statementTotalWithdrawals').textContent = formatCurrency(Math.random() * 15000 + 3000);
            document.getElementById('statementEndingBalance').textContent = formatCurrency(Math.random() * 150000 + 50000);
            
            setTimeout(() => {
                showToast('Success', 'Statement data refreshed!', 'success');
            }, 1000);
        }

        // ==============================
        // UPDATED RECEIPT FUNCTIONS WITH SMALLER DESIGN
        // ==============================
        async function downloadReceiptAsPDF(transaction) {
            try {
                showToast('Generating', 'Creating PDF receipt...', 'info');
                
                // Use html2canvas to capture the receipt
                const receiptElement = document.createElement('div');
                receiptElement.innerHTML = generateReceiptHTML(transaction);
                receiptElement.style.position = 'absolute';
                receiptElement.style.left = '-9999px';
                receiptElement.style.top = '0';
                receiptElement.style.width = '380px';
                receiptElement.style.backgroundColor = 'white';
                receiptElement.style.padding = '20px';
                document.body.appendChild(receiptElement);
                
                const canvas = await html2canvas(receiptElement);
                document.body.removeChild(receiptElement);
                
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save(`Receipt_${transaction.reference || transaction.id}.pdf`);
                
                showToast('Success', 'PDF receipt downloaded!', 'success');
            } catch (error) {
                console.error('Error generating PDF receipt:', error);
                showToast('Error', 'Failed to generate PDF. Please try again.', 'error');
            }
        }

        async function downloadReceiptAsImage(transaction) {
            try {
                showToast('Generating', 'Creating image receipt...', 'info');
                
                const receiptElement = document.createElement('div');
                receiptElement.innerHTML = generateReceiptHTML(transaction);
                receiptElement.style.position = 'absolute';
                receiptElement.style.left = '-9999px';
                receiptElement.style.top = '0';
                receiptElement.style.width = '380px';
                receiptElement.style.backgroundColor = 'white';
                receiptElement.style.padding = '20px';
                document.body.appendChild(receiptElement);
                
                const canvas = await html2canvas(receiptElement);
                document.body.removeChild(receiptElement);
                
                // Create download link
                const link = document.createElement('a');
                link.download = `Receipt_${transaction.reference || transaction.id}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showToast('Success', 'Image receipt downloaded!', 'success');
            } catch (error) {
                console.error('Error generating image receipt:', error);
                showToast('Error', 'Failed to generate image. Please try again.', 'error');
            }
        }

        function generateReceiptHTML(transaction) {
            const date = new Date(transaction.date);
            const formattedDate = date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            
            const formattedTime = date.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            return `
                <div class="receipt-container">
                    <div class="receipt-header">
                        <div class="receipt-logo">Bare Zorynth</div>
                        <div class="receipt-title">Transaction Receipt</div>
                        <div style="font-size: var(--font-size-xs); color: var(--text-light); margin-top: 4px;">${formattedDate}</div>
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <div style="font-size: var(--font-size-2xl); font-weight: bold; color: var(--primary-blue); margin-bottom: 8px;">
                            ${transaction.type === 'credit' ? '+' : '-'}${formatCurrency(Math.abs(transaction.amount))}
                        </div>
                        <div style="color: var(--text-gray); font-size: var(--font-size-sm);">${transaction.description}</div>
                    </div>
                    
                    <div class="receipt-details">
                        <div class="receipt-row">
                            <span class="receipt-label">Transaction ID:</span>
                            <span class="receipt-value">${transaction.reference || transaction.id}</span>
                        </div>
                        <div class="receipt-row">
                            <span class="receipt-label">Status:</span>
                            <span class="receipt-value" style="color: ${transaction.status === 'completed' ? 'var(--success-green)' : transaction.status === 'pending' ? 'var(--warning-orange)' : 'var(--danger-red)'};">
                                ${transaction.status.charAt(0).toUpperCase() + transaction.status.slice(1)}
                            </span>
                        </div>
                        ${transaction.bank ? `
                        <div class="receipt-row">
                            <span class="receipt-label">Bank:</span>
                            <span class="receipt-value">${transaction.bank}</span>
                        </div>
                        ` : ''}
                        ${transaction.recipientName ? `
                        <div class="receipt-row">
                            <span class="receipt-label">Recipient:</span>
                            <span class="receipt-value">${transaction.recipientName}</span>
                        </div>
                        ` : ''}
                        <div class="receipt-row">
                            <span class="receipt-label">Date & Time:</span>
                            <span class="receipt-value">${formattedTime}</span>
                        </div>
                    </div>
                    
                    <div class="receipt-footer">
                        <p>Thank you for banking with Bare Zorynth.</p>
                        <p>This is an electronic receipt. Please save for your records.</p>
                        <p>FDIC Insured  Member FDIC</p>
                        <p style="margin-top: 8px; font-size: 9px;">Receipt generated: ${new Date().toLocaleString()}</p>
                    </div>
                </div>
            `;
        }

        // ==============================
        // UPDATED TRANSACTIONS LIST - REMOVED EDIT BUTTON FOR NON-ADMIN
        // ==============================
        function updateTransactionsList() {
            const transactionsList = document.getElementById('transactionsList');
            const noTransactions = document.getElementById('noTransactions');
            
            if (userTransactions.length === 0) {
                transactionsList.innerHTML = '';
                noTransactions.style.display = 'block';
                return;
            }
            
            noTransactions.style.display = 'none';
            transactionsList.innerHTML = '';
            
            // Sort transactions by date (newest first)
            const sortedTransactions = [...userTransactions].sort((a, b) => 
                new Date(b.date) - new Date(a.date)
            );
            
            sortedTransactions.slice(0, 5).forEach(transaction => {
                const transactionItem = document.createElement('div');
                transactionItem.className = 'transaction-item';
                transactionItem.dataset.transactionId = transaction.id;
                
                const amountClass = transaction.type === 'credit' ? 'credit' : 'debit';
                const amountSign = transaction.type === 'credit' ? '+' : '-';
                const date = new Date(transaction.date);
                const dateStr = date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                // Get appropriate icon
                let iconClass = 'fas fa-exchange-alt';
                let iconColor = 'var(--primary-blue)';
                if (transaction.category === 'shopping') {
                    iconClass = 'fas fa-shopping-cart';
                    iconColor = 'var(--warning-orange)';
                }
                if (transaction.category === 'food') {
                    iconClass = 'fas fa-utensils';
                    iconColor = 'var(--success-green)';
                }
                if (transaction.category === 'salary') {
                    iconClass = 'fas fa-building';
                    iconColor = 'var(--accent-gold)';
                }
                if (transaction.category === 'transfer') {
                    iconClass = 'fas fa-exchange-alt';
                    iconColor = 'var(--primary-blue)';
                }
                if (transaction.category === 'bill') {
                    iconClass = 'fas fa-file-invoice';
                    iconColor = 'var(--danger-red)';
                }
                if (transaction.category === 'investment') {
                    iconClass = 'fas fa-chart-line';
                    iconColor = 'var(--accent-gold)';
                }
                if (transaction.category === 'entertainment') {
                    iconClass = 'fas fa-film';
                    iconColor = 'var(--admin-purple)';
                }
                
                // UPDATED: Only show download button, edit button removed for non-admin users
                transactionItem.innerHTML = `
                    <div class="transaction-icon" style="background-color: ${iconColor}20; color: ${iconColor};">
                        <i class="${iconClass}"></i>
                    </div>
                    <div class="transaction-details">
                        <div class="transaction-name">${transaction.description}</div>
                        <div class="transaction-date">${dateStr}  ${formatCategory(transaction.category)}</div>
                        ${transaction.bank ? `<div class="transaction-date" style="font-size: 10px;">Bank: ${transaction.bank}</div>` : ''}
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div class="transaction-amount ${amountClass}">
                            ${amountSign}${formatCurrency(Math.abs(transaction.amount))}
                        </div>
                        <button class="transaction-download-btn" data-transaction-id="${transaction.id}">
                            <i class="fas fa-download"></i>
                        </button>
                        <!-- Edit button only for admin users -->
                        ${isAdmin ? `
                            <button class="transaction-download-btn" style="background-color:none; display:none;" data-transaction-edit-id="${transaction.id}">
                                
                            </button>
                        ` : ''}
                    </div>
                `;
                
                // Add click event for details
                transactionItem.addEventListener('click', () => {
                    showTransactionDetails(transaction);
                });
                
                // Add click event for download button
                const downloadBtn = transactionItem.querySelector('.transaction-download-btn[data-transaction-id]');
                downloadBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    downloadTransactionReceipt(transaction);
                });
                
                // Add click event for edit button (admin only)
                if (isAdmin) {
                    const editBtn = transactionItem.querySelector('.transaction-download-btn[data-transaction-edit-id]');
                    editBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showAdminTransactionEdit(transaction);
                    });
                }
                
                transactionsList.appendChild(transactionItem);
            });
        }

        // ==============================
        // UPDATED RECEIPT DOWNLOAD FUNCTION WITH SMALLER MODAL
        // ==============================
        function downloadTransactionReceipt(transaction) {
            // Create receipt content with smaller design
            const receiptContent = generateReceiptHTML(transaction);
            
            document.getElementById('receiptContent').innerHTML = receiptContent;
            document.getElementById('receiptModal').classList.add('active');
            
            // Add event listeners for download buttons
            document.getElementById('downloadPdfBtn').onclick = () => {
                downloadReceiptAsPDF(transaction);
            };
            
            document.getElementById('downloadImageBtn').onclick = () => {
                downloadReceiptAsImage(transaction);
            };
            
            document.getElementById('printReceiptBtn').onclick = () => {
                window.print();
            };
        }

        // ==============================
        // AUTHENTICATION STATE CHECKING
        // ==============================
        function checkAuthState() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    console.log("User is already logged in:", user.email);
                    currentUser = user;
                    
                    // Set persistence
                    await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
                    
                    // Load user data
                    await loadUserData();
                    
                    // Show dashboard page
                    showDashboardPage();
                    
                    // Update login status in localStorage
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', user.email);
                } else {
                    console.log("No user logged in, showing login page");
                    
                    // Check if we should stay on login page or show create account
                    const urlParams = new URLSearchParams(window.location.search);
                    if (urlParams.get('action') === 'create-account') {
                        showCreateAccountModal();
                    }
                    
                    showLoginPage();
                    
                    // Clear login status from localStorage
                    localStorage.removeItem('userLoggedIn');
                    localStorage.removeItem('userEmail');
                }
            });
        }

        // Update current date function
        function updateCurrentDate() {
            const currentDate = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('currentDate').textContent = currentDate.toLocaleDateString('en-US', options);
        }

        // ==============================
        // PAGE MANAGEMENT FUNCTIONS
        // ==============================
        function showLoginPage() {
            console.log("Showing login page");
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('dashboardPage').classList.add('hidden');
            
            // Reset form
            document.getElementById('loginForm').reset();
            
            // Auto-focus email input
            const emailInput = document.getElementById('email');
            if (emailInput && window.innerWidth >= 992) {
                emailInput.focus();
            }
            
            // Load remembered email if exists
            const rememberedEmail = localStorage.getItem('rememberedEmail');
            if (rememberedEmail) {
                emailInput.value = rememberedEmail;
                document.getElementById('rememberMe').checked = true;
            }
        }

        function showDashboardPage() {
            console.log("Showing dashboard page");
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('dashboardPage').classList.remove('hidden');
            
            // Update current date
            updateCurrentDate();
            
            // Show mobile bottom nav on mobile
            if (window.innerWidth <= 992) {
                document.getElementById('mobileBottomNav').classList.add('active');
            }
            
            // Show dashboard section by default
            showSection('dashboard');
        }

        // ==============================
        // AUTHENTICATION FUNCTIONS
        // ==============================
        async function authenticateUser(email, password, rememberMe) {
            console.log("Starting authentication for:", email);
            
            try {
                // Show loading state
                const loadingSpinner = document.getElementById('loadingSpinner');
                const loginButton = document.getElementById('loginButton');
                loadingSpinner.classList.add('active');
                const originalText = loginButton.innerHTML;
                loginButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Authenticating...';
                loginButton.disabled = true;
                
                // Set persistence mode
                const persistence = rememberMe ? 
                    firebase.auth.Auth.Persistence.LOCAL : 
                    firebase.auth.Auth.Persistence.SESSION;
                
                await auth.setPersistence(persistence);
                
                // Check if user exists in Firestore
                const usersSnapshot = await db.collection('users')
                    .where('email', '==', email.toLowerCase())
                    .limit(1)
                    .get();
                
                if (usersSnapshot.empty) {
                    console.log("No user found in Firestore");
                    throw new Error('auth/user-not-found');
                }
                
                // User exists in Firestore, now try to sign in with Firebase Auth
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                console.log("Firebase Auth successful!");
                
                // Get user data from Firestore
                const userDoc = usersSnapshot.docs[0];
                userData = userDoc.data();
                userData.id = userDoc.id;
                
                // Get user PIN from Firestore - IMPORTANT: This loads the PIN from Firebase
                userPin = userData.pin || null;
                console.log("User PIN loaded from Firestore:", userPin ? "PIN loaded (hidden for security)" : "No PIN found");
                
                // Update last login
                await db.collection('users').doc(userDoc.id).update({
                    lastLogin: new Date().toISOString()
                });
                
                // Save to localStorage if remember me is checked
                if (rememberMe) {
                    localStorage.setItem('rememberedEmail', email);
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', email);
                } else {
                    localStorage.removeItem('rememberedEmail');
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', email);
                }
                
                // Set global user variables
                currentUser = userCredential.user;
                isAdmin = userData.role === 'admin';
                
                // Show success message
                showToast('Success', `Welcome back, ${userData.firstName || 'User'}!`, 'success');
                
                // Load user data and show dashboard
                await loadUserData();
                showDashboardPage();
                
            } catch (error) {
                console.error("Authentication error:", error);
                const loginButton = document.getElementById('loginButton');
                
                // Handle specific Firebase errors
                let errorMessage = 'Login failed. Please try again.';
                
                switch (error.code || error.message) {
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address format.';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'This account has been disabled by the administrator.';
                        break;
                    case 'auth/user-not-found':
                        errorMessage = 'No account found with this email. Please check your credentials or contact your administrator.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password. Please try again.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'Too many failed attempts. Please try again later.';
                        break;
                    case 'auth/network-request-failed':
                        errorMessage = 'Network error. Please check your connection.';
                        break;
                    default:
                        errorMessage = error.message || 'Login failed. Please contact your administrator.';
                }
                
                showToast('Login Failed', errorMessage, 'error');
                
            } finally {
                const loadingSpinner = document.getElementById('loadingSpinner');
                const loginButton = document.getElementById('loginButton');
                loadingSpinner.classList.remove('active');
                loginButton.innerHTML = originalText;
                loginButton.disabled = false;
            }
        }

        // ==============================
        // CREATE ACCOUNT FUNCTIONS - UPDATED TO STORE PIN IN FIREBASE
        // ==============================
        function showCreateAccountModal() {
            document.getElementById('createAccountModal').classList.add('active');
            resetCreateAccountForm();
        }

        function resetCreateAccountForm() {
            currentStep = 1;
            
            // Reset all form steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById('step1').classList.add('active');
            
            // Reset step indicators
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active');
                if (index === 0) step.classList.add('active');
            });
            
            // Reset form values
            document.getElementById('createAccountForm').reset();
            document.getElementById('profilePictureUrl').value = '';
            document.getElementById('profilePreview').style.display = 'none';
            document.getElementById('profileInitialsPreview').style.display = 'flex';
            document.getElementById('removeProfilePictureBtn').style.display = 'none';
            
            // Reset PIN inputs
            document.querySelectorAll('.pin-input').forEach(input => {
                input.value = '';
            });
            
            // Set default initials
            const firstName = document.getElementById('firstName').value || 'J';
            const lastName = document.getElementById('lastName').value || 'D';
            const initials = (firstName.charAt(0) + lastName.charAt(0)).toUpperCase();
            document.getElementById('profileInitialsPreview').textContent = initials;
        }

        async function createNewAccount(accountData) {
            try {
                console.log("Creating new account for:", accountData.email);
                
                // Show loading
                showToast('Creating Account', 'Setting up your new account...', 'info');
                
                // Create user in Firebase Auth
                const userCredential = await auth.createUserWithEmailAndPassword(
                    accountData.email, 
                    accountData.password
                );
                
                // Prepare user data for Firestore - INCLUDING PIN
                const userData = {
                    firstName: accountData.firstName,
                    lastName: accountData.lastName,
                    email: accountData.email.toLowerCase(),
                    phone: accountData.phone,
                    dateOfBirth: accountData.dateOfBirth,
                    address: {
                        street: accountData.streetAddress,
                        city: accountData.city,
                        state: accountData.state,
                        zipCode: accountData.zipCode,
                        country: accountData.country
                    },
                    pin: accountData.pin, // Store PIN in Firestore - IMPORTANT!
                    role: accountData.role || 'user',
                    status: 'active',
                    profilePicture: accountData.profilePicture || '',
                    createdAt: new Date().toISOString(),
                    lastLogin: new Date().toISOString(),
                    accountNumber: generateAccountNumber(),
                    accounts: {
                        checking: {
                            balance: 1000.00, // Starting balance
                            accountNumber: ' 5678',
                            fullNumber: '4500 1234 5678 9012',
                            type: 'checking',
                            currency: 'USD'
                        },
                        savings: {
                            balance: 5000.00, // Starting balance
                            accountNumber: ' 9012',
                            fullNumber: '4500 9876 5432 1098',
                            type: 'savings',
                            currency: 'USD'
                        },
                        investment: {
                            balance: 25000.00, // Starting balance for investment
                            accountNumber: ' 3456',
                            type: 'investment',
                            portfolioType: 'IRA  Roth Account',
                            currency: 'USD',
                            ytdReturn: 5.2
                        }
                    }
                };
                
                // Save user data to Firestore (including PIN)
                await db.collection('users').doc(userCredential.user.uid).set(userData);
                
                // Set current user and data
                currentUser = userCredential.user;
                userData.id = userCredential.user.uid;
                isAdmin = userData.role === 'admin';
                userPin = accountData.pin; // Store PIN locally for verification
                
                // Update UI
                updateUserProfile();
                
                // Close create account modal
                document.getElementById('createAccountModal').classList.remove('active');
                
                // Show success message
                showToast('Account Created', 'Your account has been created successfully!', 'success');
                
                // Load user data and show dashboard
                await loadUserData();
                showDashboardPage();
                
            } catch (error) {
                console.error("Error creating account:", error);
                
                let errorMessage = 'Failed to create account. Please try again.';
                
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'This email is already registered.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address.';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password is too weak. Use at least 8 characters.';
                        break;
                    case 'auth/network-request-failed':
                        errorMessage = 'Network error. Please check your connection.';
                        break;
                    default:
                        errorMessage = error.message;
                }
                
                showToast('Account Creation Failed', errorMessage, 'error');
            }
        }

        function generateAccountNumber() {
            const randomNum = Math.floor(1000000000 + Math.random() * 9000000000);
            return `BZ${randomNum}`;
        }

        // ==============================
        // PROFILE PICTURE FUNCTIONS
        // ==============================
        function initCloudinaryWidget() {
            if (!cloudinaryWidget) {
                cloudinaryWidget = cloudinary.createUploadWidget(
                    {
                        cloudName: cloudinaryConfig.cloudName,
                        uploadPreset: cloudinaryConfig.uploadPreset,
                        sources: ['local', 'url', 'camera'],
                        multiple: false,
                        cropping: true,
                        croppingAspectRatio: 1,
                        maxFileSize: 5000000, // 5MB
                        styles: {
                            palette: {
                                window: "#FFFFFF",
                                windowBorder: "#1A237E",
                                tabIcon: "#1A237E",
                                menuIcons: "#1A237E",
                                textDark: "#121212",
                                textLight: "#FFFFFF",
                                link: "#1A237E",
                                action: "#FF620C",
                                inactiveTabIcon: "#666666",
                                error: "#F44235",
                                inProgress: "#1A237E",
                                complete: "#20B832",
                                sourceBg: "#F5F7FA"
                            }
                        }
                    },
                    (error, result) => {
                        if (!error && result && result.event === "success") {
                            const imageUrl = result.info.secure_url;
                            
                            if (currentUser) {
                                // Update profile picture for logged in user
                                updateProfilePicture(imageUrl);
                            } else {
                                // For create account form
                                document.getElementById('profilePictureUrl').value = imageUrl;
                                document.getElementById('profilePreview').src = imageUrl;
                                document.getElementById('profilePreview').style.display = 'block';
                                document.getElementById('profileInitialsPreview').style.display = 'none';
                                document.getElementById('removeProfilePictureBtn').style.display = 'block';
                            }
                        }
                    }
                );
            }
        }

        async function updateProfilePicture(imageUrl) {
            try {
                if (!currentUser) return;
                
                // Update in Firestore
                await db.collection('users').doc(currentUser.uid).update({
                    profilePicture: imageUrl,
                    updatedAt: new Date().toISOString()
                });
                
                // Update local data
                userData.profilePicture = imageUrl;
                
                // Update UI
                updateAvatarDisplay(imageUrl);
                
                // Store in localStorage for faster access
                localStorage.setItem(`profilePic_${currentUser.uid}`, imageUrl);
                
                showToast('Success', 'Profile picture updated!', 'success');
                
            } catch (error) {
                console.error('Error updating profile picture:', error);
                showToast('Error', 'Failed to update profile picture.', 'error');
            }
        }

        function updateAvatarDisplay(imageUrl) {
            // Update main avatar
            const avatarImage = document.getElementById('avatarImage');
            const avatarInitials = document.getElementById('avatarInitials');
            
            if (imageUrl) {
                avatarImage.src = imageUrl;
                avatarImage.style.display = 'block';
                avatarInitials.style.display = 'none';
            } else {
                avatarImage.style.display = 'none';
                avatarInitials.style.display = 'block';
            }
            
            // Update menu avatar
            const menuAvatarImage = document.getElementById('menuAvatarImage');
            const menuAvatarInitials = document.getElementById('menuAvatarInitials');
            
            if (menuAvatarImage && menuAvatarInitials) {
                if (imageUrl) {
                    menuAvatarImage.src = imageUrl;
                    menuAvatarImage.style.display = 'block';
                    menuAvatarInitials.style.display = 'none';
                } else {
                    menuAvatarImage.style.display = 'none';
                    menuAvatarInitials.style.display = 'block';
                }
            }
            
            // Update profile section avatar
            const profileSectionImage = document.getElementById('profileSectionImage');
            const profileSectionAvatar = document.getElementById('profileSectionAvatar');
            
            if (profileSectionImage && profileSectionAvatar) {
                if (imageUrl) {
                    profileSectionImage.src = imageUrl;
                    profileSectionImage.style.display = 'block';
                    profileSectionAvatar.style.display = 'none';
                } else {
                    profileSectionImage.style.display = 'none';
                    profileSectionAvatar.style.display = 'block';
                }
            }
        }

        async function loadProfilePicture() {
            try {
                if (!currentUser || !userData) return;
                
                // Check localStorage first for faster loading
                const cachedImage = localStorage.getItem(`profilePic_${currentUser.uid}`);
                if (cachedImage) {
                    updateAvatarDisplay(cachedImage);
                    return cachedImage;
                }
                
                // Check user data for profile picture
                if (userData.profilePicture) {
                    updateAvatarDisplay(userData.profilePicture);
                    localStorage.setItem(`profilePic_${currentUser.uid}`, userData.profilePicture);
                    return userData.profilePicture;
                }
                
                // Show initials if no profile picture
                showInitials();
                
            } catch (error) {
                console.error('Error loading profile picture:', error);
                showInitials();
            }
        }

        function showInitials() {
            if (!userData) return;
            
            const firstName = userData.firstName || 'U';
            const lastName = userData.lastName || 's';
            const initials = (firstName.charAt(0) + lastName.charAt(0)).toUpperCase();
            
            // Update all initials displays
            document.getElementById('avatarInitials').textContent = initials;
            document.getElementById('menuAvatarInitials').textContent = initials;
            document.getElementById('profileSectionAvatar').textContent = initials;
            
            // Ensure images are hidden
            document.getElementById('avatarImage').style.display = 'none';
            document.getElementById('menuAvatarImage').style.display = 'none';
            document.getElementById('profileSectionImage').style.display = 'none';
            
            // Ensure initials are shown
            document.getElementById('avatarInitials').style.display = 'block';
            document.getElementById('menuAvatarInitials').style.display = 'block';
            document.getElementById('profileSectionAvatar').style.display = 'block';
        }

        // ==============================
        // FIREBASE DATA LOADING
        // ==============================
        async function loadUserData() {
            try {
                console.log("Loading user data for:", currentUser.uid);
                
                // Load user profile from Firestore
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                
                if (userDoc.exists) {
                    userData = userDoc.data();
                    userData.id = userDoc.id;
                    isAdmin = userData.role === 'admin';
                    userPin = userData.pin || null; // Load PIN from Firestore
                    
                    console.log("Loaded user PIN from Firestore:", userPin ? "PIN loaded (hidden for security)" : "No PIN found");
                    
                    // Load profile picture
                    await loadProfilePicture();
                    
                    // Show/hide admin features
                    if (isAdmin) {
                        document.getElementById('adminDivider').style.display = 'block';
                        document.getElementById('adminNav').style.display = 'flex';
                        document.getElementById('adminPanel').style.display = 'block';
                        
                        // Load all users for admin
                        await loadAllUsers();
                    }
                    
                    updateUserProfile();
                    
                    // Load user accounts
                    await loadUserAccounts();
                    
                    // Load transactions
                    await loadTransactions();
                    
                    // Load contacts
                    await loadContacts();
                    
                    // Load bills
                    await loadBills();
                    
                    // Load loans
                    await loadLoans();
                    
                    // Load cards
                    await loadCards();
                    
                    // Update all UI elements
                    updateDashboardUI();
                    
                    // Update profile section
                    updateProfileSection();
                    
                    // Show dashboard content
                    document.getElementById('dashboardLoadingSpinner').classList.remove('active');
                    document.getElementById('dashboardContent').style.display = 'block';
                    
                } else {
                    // User document doesn't exist, sign out
                    console.log("User document not found, signing out");
                    await auth.signOut();
                    localStorage.removeItem('userLoggedIn');
                    localStorage.removeItem('userEmail');
                    showToast('Error', 'User account not found. Please contact administrator.', 'error');
                    showLoginPage();
                }

            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Error', 'Failed to load user data. Please try again.', 'error');
            }
        }

        async function loadUserAccounts() {
            try {
                // First check if accounts exist in user document
                if (userData.accounts) {
                    userAccounts = userData.accounts;
                } else {
                    // Try to load from accounts subcollection
                    const accountsSnapshot = await db.collection('users').doc(currentUser.uid).collection('accounts').get();
                    
                    userAccounts = {};
                    if (!accountsSnapshot.empty) {
                        accountsSnapshot.forEach(doc => {
                            userAccounts[doc.id] = doc.data();
                        });
                    } else {
                        // Create default accounts if none exist
                        await createDefaultAccounts();
                    }
                }
                
                console.log('Loaded user accounts:', userAccounts);
                
            } catch (error) {
                console.error('Error loading user accounts:', error);
                // Create demo accounts as fallback
                userAccounts = {
                    checking: {
                        type: 'checking',
                        balance: 12500.75,
                        accountNumber: ' 5678',
                        fullNumber: '4500 1234 5678 9012',
                        currency: 'USD',
                        status: 'active',
                        interestRate: 0.01,
                        overdraftLimit: 1000,
                        availableBalance: 12500.75
                    },
                    savings: {
                        type: 'savings',
                        balance: 32500.50,
                        accountNumber: ' 9012',
                        fullNumber: '4500 9876 5432 1098',
                        currency: 'USD',
                        status: 'active',
                        interestRate: 2.5,
                        annualYield: 3.2,
                        monthlyInterest: 67.71
                    },
                    investment: {
                        balance: 25000.00,
                        accountNumber: ' 3456',
                        type: 'investment',
                        portfolioType: 'IRA  Roth Account',
                        currency: 'USD',
                        ytdReturn: 5.2
                    }
                };
            }
        }

        async function createDefaultAccounts() {
            const defaultAccounts = {
                checking: {
                    type: 'checking',
                    balance: 12500.75,
                    accountNumber: ' 5678',
                    fullNumber: '4500 1234 5678 9012',
                    currency: 'USD',
                    status: 'active',
                    interestRate: 0.01,
                    overdraftLimit: 1000,
                    availableBalance: 12500.75
                },
                savings: {
                    type: 'savings',
                    balance: 32500.50,
                    accountNumber: ' 9012',
                    fullNumber: '4500 9876 5432 1098',
                    currency: 'USD',
                    status: 'active',
                    interestRate: 2.5,
                    annualYield: 3.2,
                    monthlyInterest: 67.71
                },
                investment: {
                    balance: 25000.00,
                    accountNumber: ' 3456',
                    type: 'investment',
                    portfolioType: 'IRA  Roth Account',
                    currency: 'USD',
                    ytdReturn: 5.2
                }
            };

            // Save to user document
            await db.collection('users').doc(currentUser.uid).update({
                accounts: defaultAccounts
            });
            
            userAccounts = defaultAccounts;
            
            showToast('Info', 'Default accounts created successfully.', 'info');
        }

        async function loadAllUsers() {
            try {
                const usersSnapshot = await db.collection('users').get();
                allUsers = [];
                usersSnapshot.forEach(doc => {
                    if (doc.id !== currentUser.uid) {
                        allUsers.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    }
                });
            } catch (error) {
                console.error('Error loading all users:', error);
                allUsers = [];
            }
        }

        async function loadLoans() {
            try {
                const loansSnapshot = await db.collection('users').doc(currentUser.uid)
                    .collection('loans').get();
                
                userLoans = [];
                loansSnapshot.forEach(doc => {
                    userLoans.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
            } catch (error) {
                console.error('Error loading loans:', error);
                userLoans = [];
            }
        }

        async function loadCards() {
            try {
                const cardsSnapshot = await db.collection('users').doc(currentUser.uid)
                    .collection('cards').get();
                
                userCards = [];
                cardsSnapshot.forEach(doc => {
                    userCards.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
            } catch (error) {
                console.error('Error loading cards:', error);
                userCards = [];
            }
        }

        async function loadTransactions() {
            try {
                const transactionsSnapshot = await db.collection('users').doc(currentUser.uid)
                    .collection('transactions')
                    .orderBy('date', 'desc')
                    .limit(10)
                    .get();
                
                userTransactions = [];
                transactionsSnapshot.forEach(doc => {
                    userTransactions.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // If no transactions, create demo data
                if (userTransactions.length === 0) {
                    userTransactions = [
                        {
                            id: '1',
                            type: 'debit',
                            amount: 125.50,
                            description: 'Grocery Store',
                            category: 'shopping',
                            date: new Date(Date.now() - 86400000).toISOString(),
                            status: 'completed',
                            bank: 'Chase Bank',
                            recipientName: 'Walmart'
                        },
                        {
                            id: '2',
                            type: 'credit',
                            amount: 2500.00,
                            description: 'Salary Deposit',
                            category: 'salary',
                            date: new Date(Date.now() - 172800000).toISOString(),
                            status: 'completed',
                            bank: 'Employer Bank',
                            recipientName: 'Tech Corp Inc.'
                        },
                        {
                            id: '3',
                            type: 'debit',
                            amount: 45.75,
                            description: 'Coffee Shop',
                            category: 'food',
                            date: new Date(Date.now() - 259200000).toISOString(),
                            status: 'completed',
                            bank: 'Local Cafe',
                            recipientName: 'Coffee Corner'
                        }
                    ];
                }
                
            } catch (error) {
                console.error('Error loading transactions:', error);
                userTransactions = [
                    {
                        id: '1',
                        type: 'debit',
                        amount: 125.50,
                        description: 'Grocery Store',
                        category: 'shopping',
                        date: new Date(Date.now() - 86400000).toISOString(),
                        status: 'completed',
                        bank: 'Chase Bank'
                    },
                    {
                        id: '2',
                        type: 'credit',
                        amount: 2500.00,
                        description: 'Salary Deposit',
                        category: 'salary',
                        date: new Date(Date.now() - 172800000).toISOString(),
                        status: 'completed',
                        bank: 'Employer Bank'
                    }
                ];
            }
        }

        async function loadContacts() {
            try {
                const contactsSnapshot = await db.collection('users').doc(currentUser.uid)
                    .collection('contacts').get();
                
                userContacts = [];
                contactsSnapshot.forEach(doc => {
                    userContacts.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // If no contacts, create demo data
                if (userContacts.length === 0) {
                    userContacts = [
                        {
                            id: '1',
                            name: 'John Smith',
                            accountNumber: ' 4321',
                            bank: 'Chase Bank',
                            type: 'friend'
                        },
                        {
                            id: '2',
                            name: 'Sarah Johnson',
                            accountNumber: ' 8765',
                            bank: 'Bank of America',
                            type: 'family'
                        },
                        {
                            id: '3',
                            name: 'Tech Corp Inc.',
                            accountNumber: ' 9876',
                            bank: 'Wells Fargo',
                            type: 'business'
                        }
                    ];
                }
                
            } catch (error) {
                console.error('Error loading contacts:', error);
                userContacts = [
                    {
                        id: '1',
                        name: 'John Smith',
                        accountNumber: ' 4321',
                        bank: 'Chase Bank',
                        type: 'friend'
                    }
                ];
            }
        }

        async function loadBills() {
            try {
                const billsSnapshot = await db.collection('users').doc(currentUser.uid)
                    .collection('bills')
                    .where('dueDate', '>=', new Date().toISOString().split('T')[0])
                    .orderBy('dueDate', 'asc')
                    .limit(4)
                    .get();
                
                userBills = [];
                billsSnapshot.forEach(doc => {
                    userBills.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // If no bills, create demo data
                if (userBills.length === 0) {
                    const today = new Date();
                    const nextWeek = new Date(today.getTime() + 7 * 86400000);
                    const twoWeeks = new Date(today.getTime() + 14 * 86400000);
                    
                    userBills = [
                        {
                            id: '1',
                            name: 'Electricity Bill',
                            amount: 125.75,
                            type: 'electricity',
                            dueDate: nextWeek.toISOString().split('T')[0],
                            status: 'pending'
                        },
                        {
                            id: '2',
                            name: 'Internet Bill',
                            amount: 89.99,
                            type: 'internet',
                            dueDate: twoWeeks.toISOString().split('T')[0],
                            status: 'pending'
                        }
                    ];
                }
                
            } catch (error) {
                console.error('Error loading bills:', error);
                const today = new Date();
                const nextWeek = new Date(today.getTime() + 7 * 86400000);
                
                userBills = [
                    {
                        id: '1',
                        name: 'Electricity Bill',
                        amount: 125.75,
                        type: 'electricity',
                        dueDate: nextWeek.toISOString().split('T')[0],
                        status: 'pending'
                    }
                ];
            }
        }

        // ==============================
        // UI UPDATES
        // ==============================
        function updateUserProfile() {
            const firstName = userData.firstName || 'User';
            const lastName = userData.lastName || '';
            const fullName = `${firstName} ${lastName}`.trim();
            const initials = (firstName[0] + (lastName[0] || '')).toUpperCase();
            const email = userData.email || currentUser.email;

            // Update name displays
            document.getElementById('userName').textContent = firstName;
            document.getElementById('displayName').textContent = fullName;
            document.getElementById('menuUserName').textContent = fullName;
            document.getElementById('menuUserEmail').textContent = email;

            // Update account number
            const checkingAccount = userAccounts.checking?.accountNumber || ' 5678';
            document.getElementById('accountNumber').textContent = `Account: ${checkingAccount}`;
        }

        function updateProfileSection() {
            const firstName = userData.firstName || 'User';
            const lastName = userData.lastName || '';
            const fullName = `${firstName} ${lastName}`.trim();
            const email = userData.email || currentUser.email;
            
            document.getElementById('profileSectionName').textContent = fullName;
            document.getElementById('profileSectionEmail').textContent = email;
            document.getElementById('profileSectionEmailDisplay').textContent = email;
            
            // Update phone and address if available
            if (userData.phone) {
                document.getElementById('profileSectionPhone').textContent = userData.phone;
            }
            
            if (userData.address) {
                const address = userData.address;
                document.getElementById('profileSectionAddress').textContent = 
                    `${address.street || ''}, ${address.city || ''}, ${address.state || ''} ${address.zipCode || ''}`;
            }
        }

        function updateDashboardUI() {
            // Calculate total balance
            const checkingBalance = userAccounts.checking?.balance || 0;
            const savingsBalance = userAccounts.savings?.balance || 0;
            const investmentBalance = userAccounts.investment?.balance || 0;
            const totalBalance = checkingBalance + savingsBalance + investmentBalance;

            // Calculate balance change (demo data)
            const previousBalance = totalBalance * 0.95; // 5% increase for demo
            const balanceChange = ((totalBalance - previousBalance) / previousBalance * 100).toFixed(1);
            const isPositive = totalBalance >= previousBalance;

            // Update balances
            document.getElementById('totalBalance').textContent = formatCurrency(totalBalance);
            document.getElementById('checkingBalance').textContent = formatCurrency(checkingBalance);
            document.getElementById('savingsBalance').textContent = formatCurrency(savingsBalance);
            document.getElementById('investmentBalance').textContent = formatCurrency(investmentBalance || 25000);

            // Update mobile portfolio values
            document.getElementById('mobilePortfolioValue').textContent = formatCurrency(investmentBalance || 25000);
            document.getElementById('mobileYtdReturn').textContent = `+${userAccounts.investment?.ytdReturn || 5.2}%`;

            // Update balance change
            const balanceChangeEl = document.getElementById('balanceChange');
            balanceChangeEl.innerHTML = `
                <i class="fas fa-arrow-${isPositive ? 'up' : 'down'}"></i>
                <span>${isPositive ? '+' : ''}${balanceChange}% from last month</span>
            `;
            balanceChangeEl.className = `balance-change ${isPositive ? 'positive' : 'negative'}`;

            // Update account numbers
            document.getElementById('checkingNumber').textContent = userAccounts.checking?.accountNumber || ' 5678';
            document.getElementById('savingsNumber').textContent = userAccounts.savings?.accountNumber || ' 9012';
            document.getElementById('investmentType').textContent = userAccounts.investment?.portfolioType || 'IRA  Roth Account';

            // Update portfolio values
            document.getElementById('portfolioValue').textContent = formatCurrency(investmentBalance || 25000);
            document.getElementById('ytdReturn').textContent = `+${userAccounts.investment?.ytdReturn || 5.2}%`;

            // Update transactions with download buttons only (edit removed for non-admin)
            updateTransactionsList();

            // Update contacts
            updateContactsList();

            // Update bills
            updateBillsList();
            
            // Update wire transfer account number
            document.getElementById('wireAccountNumber').textContent = userAccounts.checking?.fullNumber || ' 5678';
        }

        function updateContactsList() {
            const contactsList = document.getElementById('contactsList');
            const noContacts = document.getElementById('noContacts');
            
            if (userContacts.length === 0) {
                contactsList.innerHTML = '';
                noContacts.style.display = 'block';
                return;
            }
            
            noContacts.style.display = 'none';
            contactsList.innerHTML = '';
            
            userContacts.slice(0, 4).forEach(contact => {
                const contactItem = document.createElement('div');
                contactItem.className = 'contact-item';
                contactItem.dataset.contactId = contact.id;
                
                const initials = contact.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                const colors = ['#10B981', '#3B82F6', '#8B5CF6', '#F59E0B', '#EF4444'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                contactItem.innerHTML = `
                    <div class="contact-avatar" style="background-color: ${color}20; color: ${color};">
                        ${initials}
                    </div>
                    <div class="contact-info">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-account">${contact.accountNumber || ' '}  ${contact.bank || 'Bank'}</div>
                    </div>
                    <button class="contact-transfer" data-contact-id="${contact.id}">
                        Send
                    </button>
                `;
                
                contactsList.appendChild(contactItem);
            });
        }

        function updateBillsList() {
            const billsList = document.getElementById('billsList');
            const noBills = document.getElementById('noBills');
            
            if (userBills.length === 0) {
                billsList.innerHTML = '';
                noBills.style.display = 'block';
                return;
            }
            
            noBills.style.display = 'none';
            billsList.innerHTML = '';
            
            // Sort bills by due date (closest first)
            const sortedBills = [...userBills].sort((a, b) => 
                new Date(a.dueDate) - new Date(b.dueDate)
            );
            
            sortedBills.slice(0, 4).forEach(bill => {
                const billItem = document.createElement('div');
                billItem.className = 'bill-item';
                billItem.dataset.billId = bill.id;
                
                let iconClass = 'fas fa-file-invoice';
                let iconColor = 'var(--primary-blue)';
                if (bill.type === 'electricity') {
                    iconClass = 'fas fa-bolt';
                    iconColor = 'var(--warning-orange)';
                }
                if (bill.type === 'water') {
                    iconClass = 'fas fa-tint';
                    iconColor = 'var(--primary-blue)';
                }
                if (bill.type === 'internet') {
                    iconClass = 'fas fa-wifi';
                    iconColor = 'var(--admin-purple)';
                }
                if (bill.type === 'phone') {
                    iconClass = 'fas fa-phone';
                    iconColor = 'var(--success-green)';
                }
                if (bill.type === 'credit') {
                    iconClass = 'fas fa-credit-card';
                    iconColor = 'var(--danger-red)';
                }
                if (bill.type === 'mortgage') {
                    iconClass = 'fas fa-home';
                    iconColor = 'var(--accent-gold)';
                }
                
                const dueDate = new Date(bill.dueDate);
                const today = new Date();
                const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
                let dueStr = `Due in ${daysUntilDue} days`;
                let dueColor = 'var(--text-light)';
                
                if (daysUntilDue <= 3) {
                    dueStr = `Due in ${daysUntilDue} day${daysUntilDue !== 1 ? 's' : ''} `;
                    dueColor = 'var(--danger-red)';
                } else if (daysUntilDue <= 7) {
                    dueStr = `Due in ${daysUntilDue} days`;
                    dueColor = 'var(--warning-orange)';
                }
                
                billItem.innerHTML = `
                    <div class="bill-icon" style="background-color: ${iconColor}20; color: ${iconColor};">
                        <i class="${iconClass}"></i>
                    </div>
                    <div class="bill-name">${bill.name}</div>
                    <div class="bill-amount">${formatCurrency(bill.amount)}</div>
                    <div class="bill-due" style="color: ${dueColor};">${dueStr}</div>
                `;
                
                // Add click event
                billItem.addEventListener('click', () => {
                    payBill(bill);
                });
                
                billsList.appendChild(billItem);
            });
        }

        // ==============================
        // NAVIGATION FUNCTIONS
        // ==============================
        function showSection(section) {
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Update active nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item-mobile').forEach(item => {
                item.classList.remove('active');
            });
            
            // Set current page
            currentPage = section;
            
            // Show selected section
            const sectionElement = document.getElementById(section + 'Section');
            if (sectionElement) {
                sectionElement.classList.add('active');
            }
            
            // Update active nav items based on section
            updateActiveNav(section);
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Update page title based on section
            updatePageTitle(section);
            
            // Handle transfer section specific display
            if (section === 'transfer') {
                showQuickTransferForm();
            }
            
            // Handle statement section initialization
            if (section === 'statements') {
                updateStatementPreview('current');
            }
        }

        function updateActiveNav(section) {
            // Update sidebar nav
            const navItem = document.querySelector(`.nav-item[data-section="${section}"]`);
            if (navItem) {
                navItem.classList.add('active');
            }
            
            // Update mobile bottom nav
            const mobileNavItem = document.querySelector(`.nav-item-mobile[data-section="${section}"]`);
            if (mobileNavItem) {
                mobileNavItem.classList.add('active');
            }
            
            // For sections that don't have direct mobile nav items, use the "More" button
            if (!mobileNavItem && ['settings', 'admin', 'profile', 'security', 'notifications', 'help'].includes(section)) {
                document.querySelector('.nav-item-mobile[data-section="settings"]').classList.add('active');
            }
        }

        function updatePageTitle(section) {
            const titles = {
                'dashboard': 'Dashboard',
                'transfer': 'Transfers',
                'cards': 'Cards',
                'investments': 'Investments',
                'statements': 'Statements',
                'settings': 'Settings',
                'admin': 'Admin Panel',
                'profile': 'My Profile',
                'security': 'Security',
                'notifications': 'Notifications',
                'help': 'Help & Support'
            };
            
            const title = titles[section] || 'Dashboard';
            document.title = `Bare Zorynth - ${title}`;
        }

        // ==============================
        // TRANSFER SECTION FUNCTIONS
        // ==============================
        function showQuickTransferForm() {
            document.getElementById('quickTransferForm').style.display = 'block';
            document.getElementById('wireTransferInfo').style.display = 'none';
            document.getElementById('scheduledTransfersInfo').style.display = 'none';
        }

        function showWireTransferInfo() {
            document.getElementById('quickTransferForm').style.display = 'none';
            document.getElementById('wireTransferInfo').style.display = 'block';
            document.getElementById('scheduledTransfersInfo').style.display = 'none';
        }

        function showScheduledTransfers() {
            document.getElementById('quickTransferForm').style.display = 'none';
            document.getElementById('wireTransferInfo').style.display = 'none';
            document.getElementById('scheduledTransfersInfo').style.display = 'block';
        }

        // ==============================
        // CARD MANAGEMENT FUNCTIONS
        // ==============================
        function showFreezeCardPanel() {
            document.getElementById('freezeCardPanel').style.display = 'block';
            document.getElementById('virtualCardPanel').style.display = 'none';
            document.getElementById('spendingLimitsPanel').style.display = 'none';
            document.getElementById('cardControlsPanel').style.display = 'none';
        }

        function showVirtualCardPanel() {
            document.getElementById('freezeCardPanel').style.display = 'none';
            document.getElementById('virtualCardPanel').style.display = 'block';
            document.getElementById('spendingLimitsPanel').style.display = 'none';
            document.getElementById('cardControlsPanel').style.display = 'none';
        }

        function showSpendingLimitsPanel() {
            document.getElementById('freezeCardPanel').style.display = 'none';
            document.getElementById('virtualCardPanel').style.display = 'none';
            document.getElementById('spendingLimitsPanel').style.display = 'block';
            document.getElementById('cardControlsPanel').style.display = 'none';
        }

        function showCardControlsPanel() {
            document.getElementById('freezeCardPanel').style.display = 'none';
            document.getElementById('virtualCardPanel').style.display = 'none';
            document.getElementById('spendingLimitsPanel').style.display = 'none';
            document.getElementById('cardControlsPanel').style.display = 'block';
        }

        // ==============================
        // PIN VERIFICATION FUNCTIONS - UPDATED TO USE FIREBASE PIN
        // ==============================
        function showPinVerificationModal(transferData) {
            currentTransferData = transferData;
            
            // Check if user has a PIN
            if (!userPin) {
                showToast('Error', 'PIN not found. Please contact administrator.', 'error');
                return;
            }
            
            // Reset PIN inputs
            document.querySelectorAll('#verifyPin1, #verifyPin2, #verifyPin3, #verifyPin4').forEach(input => {
                input.value = '';
            });
            
            // Focus first PIN input
            document.getElementById('verifyPin1').focus();
            
            // Show modal
            document.getElementById('pinVerificationModal').classList.add('active');
        }

        function verifyPin() {
            const pin1 = document.getElementById('verifyPin1').value;
            const pin2 = document.getElementById('verifyPin2').value;
            const pin3 = document.getElementById('verifyPin3').value;
            const pin4 = document.getElementById('verifyPin4').value;
            
            const enteredPin = pin1 + pin2 + pin3 + pin4;
            
            if (enteredPin.length !== 4) {
                showToast('Error', 'Please enter a complete 4-digit PIN.', 'error');
                return;
            }
            
            // Verify PIN from Firebase (userPin loaded from Firestore)
            if (enteredPin !== userPin) {
                showToast('Error', 'Incorrect PIN. Please try again.', 'error');
                // Clear PIN inputs
                document.querySelectorAll('#verifyPin1, #verifyPin2, #verifyPin3, #verifyPin4').forEach(input => {
                    input.value = '';
                });
                document.getElementById('verifyPin1').focus();
                return;
            }
            
            // PIN is correct, proceed with transfer
            document.getElementById('pinVerificationModal').classList.remove('active');
            
            if (currentTransferData) {
                processTransfer(currentTransferData);
            }
        }

        // ==============================
        // TRANSFER PROCESSING FUNCTIONS - UPDATED WITH PIN VERIFICATION
        // ==============================
        async function processTransfer(transferData) {
            try {
                // Disable button and show loading
                const submitBtn = transferData.isMobile ? 
                    document.querySelector('#mobileTransferForm button[type="submit"]') : 
                    document.getElementById('submitTransfer');
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                submitBtn.disabled = true;
                
                // Create transaction record
                const transactionData = {
                    type: 'debit',
                    amount: transferData.amount,
                    description: transferData.memo || `Transfer to ${transferData.recipientName}`,
                    category: 'transfer',
                    fromAccount: transferData.fromAccount,
                    bank: transferData.bankName,
                    recipientName: transferData.recipientName,
                    recipientAccount: transferData.recipientAccount,
                    transferType: transferData.transferType,
                    date: new Date().toISOString(),
                    status: 'completed',
                    reference: generateReferenceNumber(),
                    pinVerified: true
                };
                
                // Update account balance in Firestore
                const fromAccountData = userAccounts[transferData.fromAccount];
                const newBalance = fromAccountData.balance - transferData.amount;
                await db.collection('users').doc(currentUser.uid).update({
                    [`accounts.${transferData.fromAccount}.balance`]: newBalance
                });
                
                // Save transaction
                const transactionRef = await db.collection('users').doc(currentUser.uid)
                    .collection('transactions').add(transactionData);
                
                // Update local data
                fromAccountData.balance = newBalance;
                userTransactions.unshift({
                    ...transactionData,
                    id: transactionRef.id
                });
                
                // Update UI
                updateDashboardUI();
                
                // Show success modal
                const now = new Date();
                document.getElementById('successAmount').textContent = formatCurrency(transferData.amount);
                document.getElementById('successFrom').textContent = 
                    `${formatAccountType(transferData.fromAccount)}  ${fromAccountData.accountNumber || ' '}`;
                document.getElementById('successTo').textContent = transferData.recipientName;
                document.getElementById('referenceNumber').textContent = transactionData.reference;
                document.getElementById('successTime').textContent = 
                    now.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        year: 'numeric' 
                    }) + '  ' + 
                    now.toLocaleTimeString('en-US', { 
                        hour: 'numeric', 
                        minute: '2-digit', 
                        hour12: true 
                    });
                
                document.getElementById('successModal').classList.add('active');
                
                // Reset forms
                if (transferData.isMobile) {
                    document.getElementById('mobileTransferForm').reset();
                } else {
                    document.getElementById('transferForm').reset();
                }
                
                showToast('Success', 'Transfer completed successfully!', 'success');
                
            } catch (error) {
                console.error('Error processing transfer:', error);
                showToast('Error', 'Failed to process transfer. Please try again.', 'error');
            } finally {
                // Reset button
                const submitBtn = transferData.isMobile ? 
                    document.querySelector('#mobileTransferForm button[type="submit"]') : 
                    document.getElementById('submitTransfer');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // Reset current transfer data
                currentTransferData = null;
            }
        }

        // ==============================
        // ADMIN TRANSACTION EDIT FUNCTIONS
        // ==============================
        function showAdminTransactionEdit(transaction) {
            const editForm = `
                <div class="admin-form">
                    <div class="form-group">
                        <label for="editTransactionAmount" class="form-label">Amount ($)</label>
                        <input type="number" id="editTransactionAmount" class="form-control" value="${transaction.amount}" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editTransactionDescription" class="form-label">Description</label>
                        <input type="text" id="editTransactionDescription" class="form-control" value="${transaction.description}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editTransactionDate" class="form-label">Date</label>
                        <input type="date" id="editTransactionDate" class="form-control" value="${new Date(transaction.date).toISOString().split('T')[0]}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editTransactionTime" class="form-label">Time</label>
                        <input type="time" id="editTransactionTime" class="form-control" value="${new Date(transaction.date).toTimeString().split(' ')[0]}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editTransactionBank" class="form-label">Bank</label>
                        <input type="text" id="editTransactionBank" class="form-control" value="${transaction.bank || ''}">
                    </div>
                    
                    <div class="form-group">
                        <label for="editTransactionStatus" class="form-label">Status</label>
                        <select id="editTransactionStatus" class="form-control">
                            <option value="completed" ${transaction.status === 'completed' ? 'selected' : ''}>Completed</option>
                            <option value="pending" ${transaction.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="failed" ${transaction.status === 'failed' ? 'selected' : ''}>Failed</option>
                        </select>
                    </div>
                    
                    <input type="hidden" id="editTransactionId" value="${transaction.id}">
                </div>
            `;
            
            document.getElementById('adminTransactionContent').innerHTML = editForm;
            document.getElementById('adminTransactionModal').classList.add('active');
        }

        async function saveTransactionChanges() {
            try {
                const transactionId = document.getElementById('editTransactionId').value;
                const amount = parseFloat(document.getElementById('editTransactionAmount').value);
                const description = document.getElementById('editTransactionDescription').value.trim();
                const date = document.getElementById('editTransactionDate').value;
                const time = document.getElementById('editTransactionTime').value;
                const bank = document.getElementById('editTransactionBank').value.trim();
                const status = document.getElementById('editTransactionStatus').value;
                
                // Combine date and time
                const dateTime = new Date(`${date}T${time}`).toISOString();
                
                // Find transaction in local array
                const transactionIndex = userTransactions.findIndex(t => t.id === transactionId);
                if (transactionIndex === -1) {
                    throw new Error('Transaction not found');
                }
                
                // Update transaction in Firestore
                await db.collection('users').doc(currentUser.uid)
                    .collection('transactions').doc(transactionId).update({
                        amount: amount,
                        description: description,
                        date: dateTime,
                        bank: bank,
                        status: status,
                        updatedAt: new Date().toISOString()
                    });
                
                // Update local transaction
                userTransactions[transactionIndex] = {
                    ...userTransactions[transactionIndex],
                    amount: amount,
                    description: description,
                    date: dateTime,
                    bank: bank,
                    status: status
                };
                
                // Update UI
                updateDashboardUI();
                
                // Close modal
                document.getElementById('adminTransactionModal').classList.remove('active');
                
                showToast('Success', 'Transaction updated successfully!', 'success');
                
            } catch (error) {
                console.error('Error updating transaction:', error);
                showToast('Error', 'Failed to update transaction. Please try again.', 'error');
            }
        }

        // ==============================
        // EVENT LISTENERS INITIALIZATION
        // ==============================
        function initEventListeners() {
            // Initialize Cloudinary widget
            initCloudinaryWidget();
            
            // Login form submission
            document.getElementById('loginForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const email = document.getElementById('email').value.trim();
                const password = document.getElementById('password').value;
                const rememberMe = document.getElementById('rememberMe').checked;
                
                // Validation
                if (!email || !password) {
                    showToast('Error', 'Please fill in all required fields.', 'error');
                    return;
                }
                
                if (!isValidEmail(email)) {
                    showToast('Error', 'Please enter a valid email address.', 'error');
                    return;
                }
                
                // Authenticate with Firebase
                await authenticateUser(email, password, rememberMe);
            });

            // Toggle password visibility
            document.getElementById('togglePassword').addEventListener('click', function() {
                const passwordInput = document.getElementById('password');
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                
                const eyeIcon = this.querySelector('i');
                if (type === 'text') {
                    eyeIcon.classList.remove('fa-eye');
                    eyeIcon.classList.add('fa-eye-slash');
                } else {
                    eyeIcon.classList.remove('fa-eye-slash');
                    eyeIcon.classList.add('fa-eye');
                }
            });

            // Back button
            document.getElementById('backButton').addEventListener('click', function() {
                window.history.back();
            });

            // Help button
            document.getElementById('helpButton').addEventListener('click', function() {
                showHelpCenter();
            });

            // Forgot password
            document.getElementById('forgotPasswordLink').addEventListener('click', async function(e) {
                e.preventDefault();
                const email = document.getElementById('email').value.trim();
                
                if (!email) {
                    showToast('Error', 'Please enter your email address to reset password.', 'error');
                    document.getElementById('email').focus();
                    return;
                }
                
                if (!isValidEmail(email)) {
                    showToast('Error', 'Please enter a valid email address.', 'error');
                    return;
                }
                
                try {
                    showToast('Processing', 'Sending password reset email...', 'info');
                    
                    await auth.sendPasswordResetEmail(email);
                    
                    showToast(
                        'Email Sent',
                        'Password reset instructions have been sent to your email.',
                        'success'
                    );
                } catch (error) {
                    let errorMessage = 'Failed to send reset email. Please contact your administrator.';
                    
                    switch (error.code) {
                        case 'auth/invalid-email':
                            errorMessage = 'Invalid email address.';
                            break;
                        case 'auth/user-not-found':
                            errorMessage = 'No account found with this email.';
                            break;
                        case 'auth/too-many-requests':
                            errorMessage = 'Too many attempts. Please try again later.';
                            break;
                        default:
                            errorMessage = error.message;
                    }
                    
                    showToast('Error', errorMessage, 'error');
                }
            });

            // Create account button
            document.getElementById('createAccountButton').addEventListener('click', function() {
                showCreateAccountModal();
            });

            // Alternative login buttons
            document.getElementById('googleLoginBtn').addEventListener('click', function() {
                showToast('Google Login', 'Google authentication would be implemented here.', 'info');
            });

            document.getElementById('appleLoginBtn').addEventListener('click', function() {
                showToast('Apple Login', 'Apple authentication would be implemented here.', 'info');
            });

            // ==============================
            // CREATE ACCOUNT FORM EVENT LISTENERS
            // ==============================
            
            // Close create account modal
            document.getElementById('closeCreateAccountModal').addEventListener('click', function() {
                document.getElementById('createAccountModal').classList.remove('active');
            });

            // Step 1 to 2
            document.getElementById('nextStep1').addEventListener('click', function() {
                // Validate step 1
                const firstName = document.getElementById('firstName').value.trim();
                const lastName = document.getElementById('lastName').value.trim();
                const email = document.getElementById('newEmail').value.trim();
                const phone = document.getElementById('phoneNumber').value.trim();
                const dob = document.getElementById('dateOfBirth').value;
                
                if (!firstName || !lastName || !email || !phone || !dob) {
                    showToast('Error', 'Please fill all required fields.', 'error');
                    return;
                }
                
                if (!isValidEmail(email)) {
                    showToast('Error', 'Please enter a valid email address.', 'error');
                    return;
                }
                
                // Update initials preview
                const initials = (firstName.charAt(0) + lastName.charAt(0)).toUpperCase();
                document.getElementById('profileInitialsPreview').textContent = initials;
                
                // Go to step 2
                document.getElementById('step1').classList.remove('active');
                document.getElementById('step2').classList.add('active');
                document.querySelectorAll('.step')[1].classList.add('active');
                currentStep = 2;
            });

            // Step 2 navigation
            document.getElementById('prevStep2').addEventListener('click', function() {
                document.getElementById('step2').classList.remove('active');
                document.getElementById('step1').classList.add('active');
                document.querySelectorAll('.step')[1].classList.remove('active');
                currentStep = 1;
            });

            document.getElementById('nextStep2').addEventListener('click', function() {
                // Validate step 2
                const street = document.getElementById('streetAddress').value.trim();
                const city = document.getElementById('city').value.trim();
                const state = document.getElementById('state').value.trim();
                const zip = document.getElementById('zipCode').value.trim();
                const country = document.getElementById('country').value;
                const password = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (!street || !city || !state || !zip || !country || !password || !confirmPassword) {
                    showToast('Error', 'Please fill all required fields.', 'error');
                    return;
                }
                
                if (password.length < 8) {
                    showToast('Error', 'Password must be at least 8 characters long.', 'error');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showToast('Error', 'Passwords do not match.', 'error');
                    return;
                }
                
                // Go to step 3
                document.getElementById('step2').classList.remove('active');
                document.getElementById('step3').classList.add('active');
                document.querySelectorAll('.step')[2].classList.add('active');
                currentStep = 3;
            });

            // Step 3 navigation
            document.getElementById('prevStep3').addEventListener('click', function() {
                document.getElementById('step3').classList.remove('active');
                document.getElementById('step2').classList.add('active');
                document.querySelectorAll('.step')[2].classList.remove('active');
                currentStep = 2;
            });

            document.getElementById('nextStep3').addEventListener('click', function() {
                // Validate PIN
                const pin1 = document.getElementById('createPin1').value;
                const pin2 = document.getElementById('createPin2').value;
                const pin3 = document.getElementById('createPin3').value;
                const pin4 = document.getElementById('createPin4').value;
                
                const confirmPin1 = document.getElementById('confirmPin1').value;
                const confirmPin2 = document.getElementById('confirmPin2').value;
                const confirmPin3 = document.getElementById('confirmPin3').value;
                const confirmPin4 = document.getElementById('confirmPin4').value;
                
                const pin = pin1 + pin2 + pin3 + pin4;
                const confirmPin = confirmPin1 + confirmPin2 + confirmPin3 + confirmPin4;
                
                if (pin.length !== 4) {
                    showToast('Error', 'Please enter a complete 4-digit PIN.', 'error');
                    return;
                }
                
                if (!/^\d{4}$/.test(pin)) {
                    showToast('Error', 'PIN must contain only numbers.', 'error');
                    return;
                }
                
                if (pin !== confirmPin) {
                    showToast('Error', 'PINs do not match. Please try again.', 'error');
                    return;
                }
                
                // Go to step 4
                document.getElementById('step3').classList.remove('active');
                document.getElementById('step4').classList.add('active');
                document.querySelectorAll('.step')[3].classList.add('active');
                currentStep = 4;
            });

            // Step 4 navigation
            document.getElementById('prevStep4').addEventListener('click', function() {
                document.getElementById('step4').classList.remove('active');
                document.getElementById('step3').classList.add('active');
                document.querySelectorAll('.step')[3].classList.remove('active');
                currentStep = 3;
            });

            // Upload profile picture button
            document.getElementById('uploadProfilePictureBtn').addEventListener('click', function() {
                cloudinaryWidget.open();
            });

            // Remove profile picture button
            document.getElementById('removeProfilePictureBtn').addEventListener('click', function() {
                document.getElementById('profilePictureUrl').value = '';
                document.getElementById('profilePreview').style.display = 'none';
                document.getElementById('profileInitialsPreview').style.display = 'flex';
                this.style.display = 'none';
            });

            // Update initials when name changes
            document.getElementById('firstName').addEventListener('input', updateInitialsPreview);
            document.getElementById('lastName').addEventListener('input', updateInitialsPreview);

            // Submit create account form
            document.getElementById('submitCreateAccount').addEventListener('click', async function() {
                // Validate step 4
                const agreeTerms = document.getElementById('agreeTerms').checked;
                
                if (!agreeTerms) {
                    showToast('Error', 'You must agree to the Terms & Conditions.', 'error');
                    return;
                }
                
                // Gather all form data
                const accountData = {
                    firstName: document.getElementById('firstName').value.trim(),
                    lastName: document.getElementById('lastName').value.trim(),
                    email: document.getElementById('newEmail').value.trim(),
                    phone: document.getElementById('phoneNumber').value.trim(),
                    dateOfBirth: document.getElementById('dateOfBirth').value,
                    streetAddress: document.getElementById('streetAddress').value.trim(),
                    city: document.getElementById('city').value.trim(),
                    state: document.getElementById('state').value.trim(),
                    zipCode: document.getElementById('zipCode').value.trim(),
                    country: document.getElementById('country').value,
                    password: document.getElementById('newPassword').value,
                    profilePicture: document.getElementById('profilePictureUrl').value,
                    role: document.querySelector('input[name="accountType"]:checked').value,
                    pin: document.getElementById('createPin1').value + 
                         document.getElementById('createPin2').value + 
                         document.getElementById('createPin3').value + 
                         document.getElementById('createPin4').value
                };
                
                // Create the account
                await createNewAccount(accountData);
            });

            // ==============================
            // DASHBOARD EVENT LISTENERS
            // ==============================

            // Profile dropdown toggle
            document.getElementById('profileToggle')?.addEventListener('click', function(e) {
                e.stopPropagation();
                document.getElementById('profileMenu').classList.toggle('active');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function() {
                document.getElementById('profileMenu').classList.remove('active');
            });

            // Avatar upload
            document.getElementById('avatarUpload')?.addEventListener('click', function(e) {
                e.stopPropagation();
                cloudinaryWidget.open();
            });

            // Navigation items - Sidebar
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    if (section) {
                        showSection(section);
                    }
                });
            });

            // Navigation items - Mobile Bottom Nav
            document.querySelectorAll('.nav-item-mobile').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    if (section) {
                        showSection(section);
                    }
                });
            });

            // Navigation items - Profile Menu
            document.querySelectorAll('.menu-item[data-section]').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    if (section) {
                        showSection(section);
                        document.getElementById('profileMenu').classList.remove('active');
                    }
                });
            });

            // Admin navigation
            document.getElementById('adminNav')?.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('admin');
            });

            // Transfer section buttons
            document.getElementById('quickTransferBtn')?.addEventListener('click', function() {
                showQuickTransferForm();
            });

            document.getElementById('wireTransferBtnMobile')?.addEventListener('click', function() {
                showWireTransferInfo();
            });

            document.getElementById('scheduledTransfersBtn')?.addEventListener('click', function() {
                showScheduledTransfers();
            });

            // Card section buttons
            document.getElementById('freezeCardBtn')?.addEventListener('click', function() {
                showFreezeCardPanel();
            });

            document.getElementById('virtualCardBtn')?.addEventListener('click', function() {
                showVirtualCardPanel();
            });

            document.getElementById('spendingLimitBtn')?.addEventListener('click', function() {
                showSpendingLimitsPanel();
            });

            document.getElementById('cardControlsBtn')?.addEventListener('click', function() {
                showCardControlsPanel();
            });

            // Quick action buttons
            document.getElementById('payBillBtn')?.addEventListener('click', () => {
                showBillPaymentSection();
            });
            
            document.getElementById('depositCheckBtn')?.addEventListener('click', () => {
                showCheckDepositModal();
            });
            
            document.getElementById('wireTransferBtn')?.addEventListener('click', () => {
                showWireTransferModal();
            });
            
            document.getElementById('findAtmBtn')?.addEventListener('click', () => {
                showAtmLocator();
            });

            // Summary action buttons
            document.getElementById('addMoneyBtn')?.addEventListener('click', () => {
                showAddMoneyModal();
            });
            
            document.getElementById('withdrawBtn')?.addEventListener('click', () => {
                showWithdrawModal();
            });
            
            document.getElementById('loanBtn')?.addEventListener('click', () => {
                showLoanApplication();
            });

            // Card action buttons
            document.querySelectorAll('.card-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.dataset.action;
                    const account = this.dataset.account;
                    const accountData = userAccounts[account];
                    
                    switch(action) {
                        case 'transfer':
                            document.getElementById('fromAccount').value = account;
                            document.getElementById('transferForm').scrollIntoView({ behavior: 'smooth' });
                            showToast('Transfer', `Ready to transfer from ${formatAccountType(account)}`, 'info');
                            break;
                        case 'details':
                            showAccountDetails(account);
                            break;
                        case 'statement':
                            downloadStatement('pdf');
                            break;
                        case 'interest':
                            showInterestDetails(account);
                            break;
                        case 'invest':
                            showInvestmentOptions();
                            break;
                        case 'performance':
                            showPortfolioPerformance();
                            break;
                    }
                });
            });

            // Transfer form submission - UPDATED TO SHOW PIN VERIFICATION MODAL
            document.getElementById('transferForm')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const fromAccount = document.getElementById('fromAccount').value;
                const bankName = document.getElementById('bankName').value.trim();
                const recipientName = document.getElementById('recipientName').value.trim();
                const recipientAccount = document.getElementById('recipientAccount').value.trim();
                const amount = parseFloat(document.getElementById('transferAmount').value);
                const memo = document.getElementById('transferMemo').value.trim();
                const transferType = document.querySelector('input[name="transferType"]:checked').value;
                
                // Validation
                if (!bankName || !recipientName || !recipientAccount || !amount || amount <= 0) {
                    showToast('Error', 'Please fill all required fields with valid information.', 'error');
                    return;
                }
                
                const fromAccountData = userAccounts[fromAccount];
                if (!fromAccountData) {
                    showToast('Error', 'Selected account not found.', 'error');
                    return;
                }
                
                if (amount > fromAccountData.balance) {
                    showToast('Error', 'Insufficient funds in selected account.', 'error');
                    return;
                }
                
                // Check daily limit
                if (amount > 10000) {
                    showToast('Error', 'Transfer amount exceeds daily limit of $10,000.', 'error');
                    return;
                }
                
                // Check if user has a PIN set
                if (!userPin) {
                    showToast('Error', 'PIN not found. Please contact administrator.', 'error');
                    return;
                }
                
                // Prepare transfer data
                const transferData = {
                    fromAccount: fromAccount,
                    bankName: bankName,
                    recipientName: recipientName,
                    recipientAccount: recipientAccount,
                    amount: amount,
                    memo: memo,
                    transferType: transferType,
                    isMobile: false
                };
                
                // Show PIN verification modal instead of checking PIN directly
                showPinVerificationModal(transferData);
            });

            // Mobile transfer form submission - UPDATED TO SHOW PIN VERIFICATION MODAL
            document.getElementById('mobileTransferForm')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const fromAccount = document.getElementById('mobileFromAccount').value;
                const bankName = document.getElementById('mobileBankName').value.trim();
                const recipientName = document.getElementById('mobileRecipient').value.trim();
                const amount = parseFloat(document.getElementById('mobileAmount').value);
                
                // Validation
                if (!bankName || !recipientName || !amount || amount <= 0) {
                    showToast('Error', 'Please fill all required fields with valid information.', 'error');
                    return;
                }
                
                const fromAccountData = userAccounts[fromAccount];
                if (!fromAccountData) {
                    showToast('Error', 'Selected account not found.', 'error');
                    return;
                }
                
                if (amount > fromAccountData.balance) {
                    showToast('Error', 'Insufficient funds in selected account.', 'error');
                    return;
                }
                
                // Check if user has a PIN set
                if (!userPin) {
                    showToast('Error', 'PIN not found. Please contact administrator.', 'error');
                    return;
                }
                
                // Prepare transfer data
                const transferData = {
                    fromAccount: fromAccount,
                    bankName: bankName,
                    recipientName: recipientName,
                    recipientAccount: ' ', // Default for mobile
                    amount: amount,
                    memo: 'Mobile Transfer',
                    transferType: 'standard',
                    isMobile: true
                };
                
                // Show PIN verification modal
                showPinVerificationModal(transferData);
            });

            // Quick contact transfers
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('contact-transfer')) {
                    const contactId = e.target.dataset.contactId;
                    const contact = userContacts.find(c => c.id === contactId);
                    
                    if (contact) {
                        // Auto-fill transfer form
                        document.getElementById('recipientName').value = contact.name;
                        document.getElementById('recipientAccount').value = contact.accountNumber || '';
                        document.getElementById('bankName').value = contact.bank || '';
                        document.getElementById('transferMemo').value = `Transfer to ${contact.name}`;
                        document.getElementById('transferAmount').focus();
                        
                        // Scroll to transfer form
                        document.getElementById('transferForm').scrollIntoView({ behavior: 'smooth' });
                        
                        showToast('Contact Selected', `Ready to transfer to ${contact.name}`, 'info');
                    }
                }
            });

            // View all transactions
            document.getElementById('viewAllTransactions')?.addEventListener('click', function(e) {
                e.preventDefault();
                showAllTransactions();
            });

            // Transfer history
            document.getElementById('transferHistoryBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                showTransferHistory();
            });

            // Manage contacts
            document.getElementById('manageContactsBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                showManageContacts();
            });

            // Add contact
            document.getElementById('addContactBtn')?.addEventListener('click', () => {
                showAddContactModal();
            });

            // View all bills
            document.getElementById('viewAllBills')?.addEventListener('click', function(e) {
                e.preventDefault();
                showAllBills();
            });

            // Setup bills
            document.getElementById('setupBillsBtn')?.addEventListener('click', () => {
                showSetupBills();
            });

            // Make first transfer
            document.getElementById('makeFirstTransferBtn')?.addEventListener('click', () => {
                document.getElementById('transferForm').scrollIntoView({ behavior: 'smooth' });
            });

            // View portfolio
            document.getElementById('viewPortfolioBtn')?.addEventListener('click', () => {
                showInvestmentDetails();
            });

            // Investment details
            document.getElementById('investmentDetailsBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                showInvestmentDetails();
            });

            // Notification button
            document.getElementById('notificationBtn')?.addEventListener('click', () => {
                showNotifications();
            });

            // Profile menu items
            document.getElementById('logoutMenuItem')?.addEventListener('click', async (e) => {
                e.preventDefault();
                try {
                    await auth.signOut();
                    localStorage.removeItem('userLoggedIn');
                    localStorage.removeItem('userEmail');
                    showToast('Signed Out', 'You have been successfully signed out.', 'success');
                    setTimeout(() => {
                        showLoginPage();
                    }, 1500);
                } catch (error) {
                    showToast('Error', 'Failed to sign out. Please try again.', 'error');
                }
            });

            // Admin buttons
            document.getElementById('editBalancesBtn')?.addEventListener('click', () => {
                showAdminBalanceEditor();
            });

            // Modal close buttons
            document.getElementById('closeModal')?.addEventListener('click', () => {
                document.getElementById('successModal').classList.remove('active');
            });

            // Download receipt button
            document.getElementById('downloadReceiptBtn')?.addEventListener('click', () => {
                // Get the latest transaction for receipt
                if (userTransactions.length > 0) {
                    downloadTransactionReceipt(userTransactions[0]);
                }
            });

            // PIN verification buttons
            document.getElementById('verifyPinBtn')?.addEventListener('click', verifyPin);
            
            document.getElementById('cancelPinBtn')?.addEventListener('click', () => {
                document.getElementById('pinVerificationModal').classList.remove('active');
                currentTransferData = null;
            });

            // Admin modal close
            document.getElementById('closeAdminModal')?.addEventListener('click', () => {
                document.getElementById('adminModal').classList.remove('active');
            });

            // Transaction modal close
            document.getElementById('closeTransactionModal')?.addEventListener('click', () => {
                document.getElementById('adminTransactionModal').classList.remove('active');
            });

            // Save transaction changes
            document.getElementById('saveTransactionChanges')?.addEventListener('click', saveTransactionChanges);

            // Feature modal close
            document.getElementById('closeFeatureModal')?.addEventListener('click', () => {
                document.getElementById('featureModal').classList.remove('active');
            });

            // Toast close
            document.getElementById('toastClose')?.addEventListener('click', () => {
                document.getElementById('toastNotification').classList.remove('show');
            });

            // Mobile action buttons
            document.getElementById('quickTransferBtn')?.addEventListener('click', () => {
                showSection('transfer');
            });

            document.getElementById('virtualCardBtn')?.addEventListener('click', () => {
                showToast('Virtual Card', 'Generating virtual card...', 'info');
            });

            document.getElementById('investNowBtn')?.addEventListener('click', () => {
                showInvestmentOptions();
            });

            document.getElementById('profileSettingsBtn')?.addEventListener('click', () => {
                showSection('profile');
            });

            document.getElementById('adminUsersBtn')?.addEventListener('click', () => {
                showManageUsers();
            });

            document.getElementById('faqBtn')?.addEventListener('click', () => {
                showHelpCenter();
            });

            // Use max button
            document.getElementById('useMaxBtn')?.addEventListener('click', function() {
                const fromAccount = document.getElementById('mobileFromAccount').value;
                const accountData = userAccounts[fromAccount];
                if (accountData) {
                    document.getElementById('mobileAmount').value = accountData.balance.toFixed(2);
                }
            });

            // Transfer speed buttons
            document.querySelectorAll('[data-speed]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-speed]').forEach(b => {
                        b.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // Start wire transfer button
            document.getElementById('startWireTransferBtn')?.addEventListener('click', () => {
                showToast('Wire Transfer', 'Initiating wire transfer process...', 'info');
            });
            
            // Schedule transfer button
            document.getElementById('scheduleTransferBtn')?.addEventListener('click', () => {
                showToast('Scheduled Transfer', 'Opening schedule transfer form...', 'info');
            });
            
            // Card freeze toggle
            document.getElementById('cardFreezeToggle')?.addEventListener('change', function() {
                const statusText = document.getElementById('cardStatusText');
                if (this.checked) {
                    statusText.textContent = 'Card is frozen';
                    showToast('Card Frozen', 'Your card has been temporarily frozen.', 'info');
                } else {
                    statusText.textContent = 'Card is active';
                    showToast('Card Activated', 'Your card is now active.', 'success');
                }
            });
            
            // Copy virtual card button
            document.getElementById('copyVirtualCardBtn')?.addEventListener('click', () => {
                navigator.clipboard.writeText('4500 1234 5678 9012');
                showToast('Copied', 'Virtual card number copied to clipboard.', 'success');
            });
            
            // Show CVV button
            document.getElementById('showCVVBtn')?.addEventListener('click', function() {
                if (this.textContent === 'Show') {
                    this.textContent = '123';
                    showToast('CVV Revealed', 'CVV displayed. Keep it secure.', 'warning');
                } else {
                    this.textContent = 'Show';
                }
            });
            
            // Generate virtual card button
            document.getElementById('generateVirtualCardBtn')?.addEventListener('click', () => {
                showToast('Virtual Card', 'Generating new virtual card...', 'info');
            });
            
            // Print receipt button
            document.getElementById('printReceiptBtn')?.addEventListener('click', () => {
                window.print();
            });
            
            // Close receipt button
            document.getElementById('closeReceiptBtn')?.addEventListener('click', () => {
                document.getElementById('receiptModal').classList.remove('active');
            });
        }

        // ==============================
        // HELPER FUNCTIONS
        // ==============================
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2
            }).format(amount || 0);
        }

        function formatAccountType(type) {
            const types = {
                'checking': 'Checking Account',
                'savings': 'Savings Account',
                'investment': 'Investment Account',
                'credit': 'Credit Card'
            };
            return types[type] || type.charAt(0).toUpperCase() + type.slice(1);
        }

        function formatCategory(category) {
            if (!category) return 'Transaction';
            const categories = {
                'shopping': 'Shopping',
                'food': 'Food & Dining',
                'salary': 'Salary',
                'transfer': 'Transfer',
                'bill': 'Bill Payment',
                'investment': 'Investment',
                'entertainment': 'Entertainment',
                'deposit': 'Deposit',
                'withdrawal': 'Withdrawal'
            };
            return categories[category] || category.charAt(0).toUpperCase() + category.slice(1);
        }

        function generateReferenceNumber() {
            const now = new Date();
            const year = now.getFullYear().toString().substring(2);
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const day = now.getDate().toString().padStart(2, '0');
            const random = Math.floor(100000 + Math.random() * 900000);
            return `TRX-${year}${month}${day}-${random}`;
        }

        function showToast(title, message, type = 'info') {
            const toast = document.getElementById('toastNotification');
            const toastIcon = document.getElementById('toastIcon');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            
            // Set type-specific styles
            toast.className = `toast toast-${type}`;
            toastIcon.className = `toast-icon toast-${type}`;
            
            // Set icons based on type
            const icons = {
                'success': 'fa-check-circle',
                'error': 'fa-exclamation-circle',
                'warning': 'fa-exclamation-triangle',
                'info': 'fa-info-circle'
            };
            
            toastIcon.innerHTML = `<i class="fas ${icons[type]}"></i>`;
            
            // Set content
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            // Show toast
            toast.classList.add('show');
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }

        function updateInitialsPreview() {
            const firstName = document.getElementById('firstName').value || 'J';
            const lastName = document.getElementById('lastName').value || 'D';
            const initials = (firstName.charAt(0) + lastName.charAt(0)).toUpperCase();
            document.getElementById('profileInitialsPreview').textContent = initials;
        }

        // ==============================
        // FEATURE MODAL FUNCTION
        // ==============================
        function showFeatureModal(title, message, content) {
            document.getElementById('featureModalTitle').textContent = title;
            document.getElementById('featureModalMessage').textContent = message;
            document.getElementById('featureModalContent').innerHTML = content;
            document.getElementById('featureModal').classList.add('active');
        }

        // ==============================
        // ADMIN FUNCTIONS - BALANCE EDITOR
        // ==============================
        function showAdminBalanceEditor() {
            // Create a simple balance editor modal
            const modalContent = `
                <div class="balance-editor">
                    <h3>Edit Account Balances</h3>
                    <div class="balance-input-group">
                        <label>Checking Balance:</label>
                        <input type="number" id="editCheckingBalance" value="${userAccounts.checking?.balance || 0}" step="0.01">
                    </div>
                    <div class="balance-input-group">
                        <label>Savings Balance:</label>
                        <input type="number" id="editSavingsBalance" value="${userAccounts.savings?.balance || 0}" step="0.01">
                    </div>
                    <div class="balance-input-group">
                        <label>Investment Balance:</label>
                        <input type="number" id="editInvestmentBalance" value="${userAccounts.investment?.balance || 0}" step="0.01">
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 16px;">
                        <button class="admin-form-button secondary" id="cancelBalanceEdit">Cancel</button>
                        <button class="admin-form-button primary" id="saveBalanceEdit">Save Changes</button>
                    </div>
                </div>
            `;
            
            document.getElementById('adminModalContent').innerHTML = modalContent;
            document.getElementById('adminModalTitle').textContent = 'Edit Account Balances';
            document.getElementById('adminModal').classList.add('active');
            
            // Add event listeners for the new buttons
            document.getElementById('cancelBalanceEdit').addEventListener('click', () => {
                document.getElementById('adminModal').classList.remove('active');
            });
            
            document.getElementById('saveBalanceEdit').addEventListener('click', async () => {
                await saveAdminBalanceEdits();
            });
        }

        async function saveAdminBalanceEdits() {
            try {
                const checkingBalance = parseFloat(document.getElementById('editCheckingBalance').value) || 0;
                const savingsBalance = parseFloat(document.getElementById('editSavingsBalance').value) || 0;
                const investmentBalance = parseFloat(document.getElementById('editInvestmentBalance').value) || 0;
                
                // Update Firestore
                const updates = {};
                
                if (userAccounts.checking) {
                    updates['accounts.checking.balance'] = checkingBalance;
                    userAccounts.checking.balance = checkingBalance;
                }
                
                if (userAccounts.savings) {
                    updates['accounts.savings.balance'] = savingsBalance;
                    userAccounts.savings.balance = savingsBalance;
                }
                
                if (userAccounts.investment) {
                    updates['accounts.investment.balance'] = investmentBalance;
                    userAccounts.investment.balance = investmentBalance;
                }
                
                await db.collection('users').doc(currentUser.uid).update(updates);
                
                // Update UI
                updateDashboardUI();
                
                // Close modal
                document.getElementById('adminModal').classList.remove('active');
                
                showToast('Success', 'Account balances updated successfully!', 'success');
                
            } catch (error) {
                console.error('Error updating balances:', error);
                showToast('Error', 'Failed to update balances. Please try again.', 'error');
            }
        }

        // ==============================
        // ADMIN PIN EDIT FUNCTIONALITY
        // ==============================
        function showAdminPinEditor(userId) {
            const modalContent = `
                <div class="balance-editor">
                    <h3>Edit User PIN</h3>
                    <div class="balance-input-group">
                        <label>New 4-digit PIN:</label>
                        <div class="pin-input-container">
                            <input type="password" maxlength="1" class="pin-input" id="adminPin1">
                            <input type="password" maxlength="1" class="pin-input" id="adminPin2">
                            <input type="password" maxlength="1" class="pin-input" id="adminPin3">
                            <input type="password" maxlength="1" class="pin-input" id="adminPin4">
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 16px;">
                        <button class="admin-form-button secondary" id="cancelPinEdit">Cancel</button>
                        <button class="admin-form-button primary" id="savePinEdit" data-user-id="${userId}">Save PIN</button>
                    </div>
                </div>
            `;
            
            document.getElementById('adminModalContent').innerHTML = modalContent;
            document.getElementById('adminModalTitle').textContent = 'Edit User PIN';
            document.getElementById('adminModal').classList.add('active');
            
            // Initialize PIN inputs
            document.querySelectorAll('#adminPin1, #adminPin2, #adminPin3, #adminPin4').forEach((input, index, inputs) => {
                input.addEventListener('input', function() {
                    if (this.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                });
            });
            
            // Add event listeners
            document.getElementById('cancelPinEdit').addEventListener('click', () => {
                document.getElementById('adminModal').classList.remove('active');
            });
            
            document.getElementById('savePinEdit').addEventListener('click', async function() {
                await saveAdminPinEdit(this.dataset.userId);
            });
        }

        async function saveAdminPinEdit(userId) {
            try {
                const pin1 = document.getElementById('adminPin1').value;
                const pin2 = document.getElementById('adminPin2').value;
                const pin3 = document.getElementById('adminPin3').value;
                const pin4 = document.getElementById('adminPin4').value;
                
                const newPin = pin1 + pin2 + pin3 + pin4;
                
                if (newPin.length !== 4) {
                    showToast('Error', 'Please enter a complete 4-digit PIN.', 'error');
                    return;
                }
                
                if (!/^\d{4}$/.test(newPin)) {
                    showToast('Error', 'PIN must contain only numbers.', 'error');
                    return;
                }
                
                // Update PIN in Firestore
                await db.collection('users').doc(userId).update({
                    pin: newPin,
                    updatedAt: new Date().toISOString()
                });
                
                // Close modal
                document.getElementById('adminModal').classList.remove('active');
                
                showToast('Success', 'User PIN updated successfully!', 'success');
                
            } catch (error) {
                console.error('Error updating PIN:', error);
                showToast('Error', 'Failed to update PIN. Please try again.', 'error');
            }
        }

        // Initialize the app when DOM is fully loaded
        window.addEventListener('load', function() {
            // Check if user was logged in before page refresh
            const wasLoggedIn = localStorage.getItem('userLoggedIn');
            const userEmail = localStorage.getItem('userEmail');
            
            if (wasLoggedIn && userEmail) {
                // Auto-focus is handled by Firebase auth state listener
                console.log("User was previously logged in, checking auth state...");
            }
            
            // Initialize Cloudinary widget
            initCloudinaryWidget();
        });

    </script>
    <script type="text/javascript">
        var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
        (function(){
        var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
        s1.async=true;
        s1.src='https://embed.tawk.to/6984ad4424574a1c3c2f755d/1jgn49l5m';
        s1.charset='UTF-8';
        s1.setAttribute('crossorigin','*');
        s0.parentNode.insertBefore(s1,s0);
        })();
        </script>
        <!--End of Tawk.to Script-->
</body>
</html>